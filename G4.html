<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade Sheet Viewer - 2081 (Class 4)</title> <!-- *** Corrected Class to 4 *** -->
    <style>
        /* Basic Styling (Mobile Friendly) - EXACTLY From 2080 Sample */
        body { font-family: 'Arial', 'Helvetica', sans-serif; margin: 0; padding: 10px; background-color: #f4f4f4; line-height: 1.6; font-size: 16px; -webkit-text-size-adjust: 100%; }
        .container { max-width: 850px; margin: 15px auto; padding: 15px; background-color: #fff; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .container h2 { text-align: center; margin-bottom: 15px; font-size: 1.5em; }
        .container > p { text-align: center; font-size: 0.9em; color: #555; margin-bottom: 15px; }

        /* Search Box - EXACTLY From 2080 Sample */
        .search-box { margin-bottom: 20px; padding: 15px; background-color: #e9ecef; border-radius: 5px; display: flex; flex-wrap: wrap; align-items: center; gap: 10px; }
        .search-box label { font-weight: bold; margin-right: 5px; flex-basis: 100%; margin-bottom: 5px; }
        .search-box input[type="text"] { padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; flex-grow: 1; min-width: 150px; font-size: 1em; }
        .search-box button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; transition: background-color 0.2s ease; font-size: 1em; flex-shrink: 0; }
        .search-box button:hover { background-color: #0056b3; }

        /* Print Button Styling - EXACTLY From 2080 Sample */
        .print-button-container {
            text-align: center;
            margin-bottom: 20px;
        }
        .print-button {
            padding: 8px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease;
        }
        .print-button:hover {
            background-color: #218838;
        }

        /* Result Area - EXACTLY From 2080 Sample */
        #resultArea { margin-top: 0; padding: 0; border: none; background-color: #fdfdfd; min-height: 50px; position: relative; }
        #resultArea.hidden { display: none; }
        #errorMessage { color: red; font-weight: bold; text-align: center; padding: 20px; }

        /* Gradesheet Specific Styles - EXACTLY From 2080 Sample */
        .gradesheet-container { padding: 15px; border: 1px solid #eee; }
        .header { text-align: center; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        .header h1 { margin: 0 0 5px 0; font-size: 1.4em; color: #333; }
        .header p { margin: 3px 0; font-size: 0.9em; color: #555; }
        .header .title { font-size: 1.2em; font-weight: bold; margin-top: 10px; color: #444; }

        /* Student Info - EXACTLY From 2080 Sample */
        .student-info { margin-bottom: 20px; padding-left: 0; }
        .info-grid { display: grid; grid-template-columns: 1fr; gap: 8px; }
        .info-item { font-size: 0.95em; padding: 3px 0; }
        .info-item span { font-weight: bold; display: inline-block; min-width: 100px; color: #333; margin-right: 5px; }

        /* Table Wrapper - EXACTLY From 2080 Sample */
        .table-wrapper { overflow-x: auto; margin-bottom: 20px; -webkit-overflow-scrolling: touch; }

        /* Grades Table - EXACTLY From 2080 Sample (with vertical-align middle) */
        .grades-table { width: 100%; min-width: 700px; border-collapse: collapse; }
        .grades-table th, .grades-table td { border: 1px solid #ddd; padding: 8px 10px; text-align: left; font-size: 0.9em; white-space: nowrap; vertical-align: middle; }
        .grades-table th { background-color: #f2f2f2; font-weight: bold; color: #333; text-align: center; }
        /* Alternating row colors as per 2080 sample */
        .grades-table tbody tr:nth-child(4n-3), .grades-table tbody tr:nth-child(4n-2) { background-color: #f9f9f9; }
        .grades-table tbody tr:nth-child(4n-1), .grades-table tbody tr:nth-child(4n) { background-color: #fff; }

        .grades-table td:nth-child(1), /* Code */
        .grades-table td:nth-child(3), /* Credit Hour */
        .grades-table td:nth-child(4), /* Grade Point */
        .grades-table td:nth-child(5) { /* Grade */
            text-align: center;
        }
        .grades-table td.final-grade-cell {
            text-align: center;
            font-weight: bold;
            vertical-align: middle;
        }
        .grades-table td.remarks-cell {
             text-align: center;
             vertical-align: middle;
        }

        /* GPA & Footer - EXACTLY From 2080 Sample */
        .gpa-section { text-align: center; font-weight: bold; font-size: 1.2em; margin-top: 20px; padding-top: 15px; border-top: 1px solid #eee; color: #2c3e50; }
        .footer-notes { margin-top: 20px; font-size: 0.8em; color: #777; border-top: 1px dashed #ccc; padding-top: 15px; }
        .footer-notes p { margin: 3px 0; }
        .na-text { color: #999; font-style: italic; }

        /* --- Media Queries for Responsiveness - EXACTLY From 2080 Sample --- */
        @media (max-width: 767px) {
            .container { margin: 10px; padding: 10px; }
            .header h1 { font-size: 1.3em; }
            .header .title { font-size: 1.1em; }
            .info-grid { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
            .grades-table th, .grades-table td { font-size: 0.85em; padding: 6px 8px; }
            .gpa-section { font-size: 1.1em; }
        }
        @media (max-width: 599px) {
            body { padding: 5px; }
            .container { margin: 5px; padding: 10px 5px; box-shadow: none; border: 1px solid #eee; }
            .container h2 { font-size: 1.3em; }
            .search-box { padding: 10px; }
            .search-box input[type="text"], .search-box button { padding: 8px 10px; font-size: 0.95em; }
            .header h1 { font-size: 1.2em; }
            .header p { font-size: 0.85em; }
            .header .title { font-size: 1em; }
            .info-grid { grid-template-columns: 1fr; gap: 5px; }
            .info-item { font-size: 0.9em; }
            .info-item span { min-width: 90px; }
            .table-wrapper { margin-bottom: 15px; }
            .grades-table th, .grades-table td { font-size: 0.8em; padding: 5px 7px; white-space: normal; }
            .gpa-section { font-size: 1.05em; }
            .footer-notes { font-size: 0.75em; }
        }

        /* --- Print Specific Styles - ***EXACTLY*** From 2080 Sample --- */
        @media print {
            body * { visibility: hidden; }
            #resultArea, #resultArea * { visibility: visible; }
            #resultArea { position: absolute; left: 0; top: 0; width: 100%; margin: 0 !important; padding: 0 !important; border: none !important; box-shadow: none !important; background-color: #fff !important; }
            .gradesheet-container { display: block !important; margin: 0 !important; padding: 15px !important; border: 1px solid #ccc !important; }
            body { margin: 10mm !important; padding: 0 !important; background-color: #fff !important; font-size: 10pt !important; color: #000 !important; visibility: visible !important; }
            .search-box, .container > h2, .container > p, .print-button-container, #errorMessage { display: none !important; visibility: hidden !important; }
            .header { border-bottom: 1px solid #ccc; padding-bottom: 10px; margin-bottom: 15px; }
            .header h1 { font-size: 14pt; }
            .header p { font-size: 10pt; }
            .header .title { font-size: 12pt; }
            .student-info { margin-bottom: 15px; }
            .info-grid { grid-template-columns: repeat(2, 1fr); gap: 5px 15px; }
            .info-item { font-size: 10pt; padding: 1px 0;}
            .info-item span { min-width: 90px; }
            .table-wrapper { overflow-x: visible; margin-bottom: 15px; }
            .grades-table { width: 100%; min-width: unset; font-size: 9pt; border: 1px solid #666; border-collapse: collapse; }
            .grades-table th, .grades-table td { padding: 4px 6px; white-space: normal; border: 1px solid #aaa; color: #000 !important; background: none !important; vertical-align: middle; }
            .grades-table th { border-bottom: 1px solid #666; background-color: #f2f2f2 !important; }
             .grades-table td:nth-child(1), /* Code */
             .grades-table td:nth-child(3), /* Credit Hour */
             .grades-table td:nth-child(4), /* Grade Point */
             .grades-table td:nth-child(5), /* Grade */
             .grades-table td.final-grade-cell,
             .grades-table td.remarks-cell {
                 text-align: center;
             }
            .gpa-section { text-align: right; font-size: 11pt; margin-top: 15px; padding-top: 10px; border-top: 1px solid #ccc; }
            .footer-notes { display: block !important; visibility: visible !important; margin-top: 15px; padding-top: 10px; border-top: 1px dashed #999; font-size: 8pt; color: #333; text-align: left; }
            .footer-notes p { margin: 2px 0; }
            .gradesheet-container, .grades-table tbody tr, .footer-notes, .header, .student-info { page-break-inside: avoid; }
            .grades-table thead { display: table-header-group; }
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Grade Sheet Viewer - Class 4 (2081)</h2> <!-- *** Corrected Class *** -->
    <p>कक्षा ४, २०८१ को नतिजा हेर्न विद्यार्थीको सिम्बोल नम्बर (e.g., 8104001) राखी खोजी गर्नुहोस्।</p> <!-- *** Corrected Class & Example *** -->

    <div class="search-box">
        <label for="symbolInput">Enter Symbol No:</label>
        <input type="text" id="symbolInput" placeholder="e.g., 8104001"> <!-- *** Corrected Example *** -->
        <button id="searchButton">Search</button>
    </div>

    <!-- Print Button Container -->
    <div class="print-button-container">
        <button id="printButton" class="print-button" onclick="printGradeSheet()" style="display: none;">Print Gradesheet</button>
    </div>

    <div id="resultArea" class="hidden">
        <!-- Grade sheet content will be dynamically inserted here -->
        <div id="gradeSheetContent">
             <!-- Placeholder -->
        </div>
         <div id="errorMessage"></div>
    </div>
</div>
<script>
    // --- DATA STORAGE & Helper Functions ---

    // School Information
    const schoolInfo = {
        name: "SURYA JYOTI SECONDARY SCHOOL MEHELKUNA",
        address: "GURBHAKOT MUNICIPALITY-8, SURKHET",
        gradeLevel: "4", // Corrected Grade
        year: "2081"
    };

    // Subject Details for 2081 - Class 4
    const subjects2081Data = {
        "4001": { thName: "COM. ENGLISH (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. ENGLISH (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "ENG" },
        "4003": { thName: "COM. NEPALI (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. NEPALI (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "NEP" },
        "4005": { thName: "COM. MATHEMATICS (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. MATHEMATICS (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "MAT" },
        "4007": { thName: "COM. SCIENCE & TECHNOLOGY (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. SCIENCE & TECHNOLOGY (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "SCI" },
        "4009": { thName: "COM. SOCIAL STUDIES AND LIFE SKILL EDU. (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. SOCIAL STUDIES AND LIFE SKILL EDU. (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "SOC" },
        "4011": { thName: "HEALTH PHY. & CREATIVE ARTS (TH)", thFM: 50, thCrHr: 1.5, inName: "HEALTH PHY. & CREATIVE ARTS (IN)", inFM: 50, inCrHr: 1.5, totalMark: 100, totalCrHr: 3, shortName: "HPC" },
        "4013": { thName: "HAMRO GURBHAKOT (TH)", thFM: 50, thCrHr: 2, inName: "HAMRO GURBHAKOT (IN)", inFM: 50, inCrHr: 2, totalMark: 100, totalCrHr: 4, shortName: "HGU" }
    };

     // Helper to get subject info safely
     function getSubjectDetails(code) {
        const stringCode = String(code);
        return subjects2081Data[stringCode] || { thName: "Unknown Subject (TH)", thCrHr: 0, inName: "Unknown Subject (IN)", inCrHr: 0 };
     }

    // --- STUDENT DATA ARRAY (Class 4, 2081) ---
    // Contains ALL 37 student records for Class 4. Rank/Percentage excluded.
    const studentGradeData = [
        { symbolNo: "8104001", name: "AADITYA CHUNARA", regNo: "5903500048003231", dob: "2071-06-29", sex: "Male", gpa: "3.3875", details: [
            { code: "4001", type: "TH", om: "32", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4001", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "4003", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4003", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "4005", type: "TH", om: "32", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4005", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "4007", type: "TH", om: "42", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4007", type: "IN", om: "49", grade: "A+", gp: "4"},
            { code: "4009", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4009", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "4011", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4011", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "4013", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "4013", type: "IN", om: "43", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8104002", name: "AASHIS  KHADKA ", regNo: "5903500138001114", dob: "2073-01-22", sex: "Male", gpa: "2.40625", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "4003", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4005", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4007", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "4009", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4013", type: "IN", om: "32", grade: "B", gp: "2.8"}
        ]},
        { symbolNo: "8104003", name: "ABHISEK KUMAI", regNo: "5903500048003232", dob: "2072-04-01", sex: "Male", gpa: null, details: [
            { code: "4001", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4001", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4003", type: "TH", om: "2", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4003", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "4005", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4005", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "4007", type: "IN", om: "39", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4009", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4011", type: "TH", om: "5", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4011", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4013", type: "TH", om: "2", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4013", type: "IN", om: "24", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104004", name: "ABINA NEPALI", regNo: "5903500137901045", dob: "2070-11-28", sex: "Female", gpa: "2.3375", details: [
            { code: "4001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4001", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4003", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4005", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4007", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "39", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4009", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4013", type: "IN", om: "29", grade: "C+", gp: "2.4"}
        ]},
        { symbolNo: "8104005", name: "ABINAM BK", regNo: "5903500137800952", dob: "2071-12-19", sex: "Male", gpa: "3.66875", details: [
            { code: "4001", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "B+", remarks: "" }, { code: "4001", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "4003", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4003", type: "IN", om: "47", grade: "A+", gp: "4"},
            { code: "4005", type: "TH", om: "42", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4005", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "4007", type: "TH", om: "42", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4007", type: "IN", om: "49", grade: "A+", gp: "4"},
            { code: "4009", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4009", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "4011", type: "TH", om: "45", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "4011", type: "IN", om: "46", grade: "A+", gp: "4"},
            { code: "4013", type: "TH", om: "38", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "4013", type: "IN", om: "45", grade: "A+", gp: "4"}
        ]},
        { symbolNo: "8104006", name: "ANUJA YARI", regNo: "5903500137700760", dob: "2070-05-04", sex: "Female", gpa: "2.2375", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4003", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4005", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "4009", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "4011", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4011", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "4013", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4013", type: "IN", om: "25", grade: "C+", gp: "2.4"}
        ]},
        { symbolNo: "8104007", name: "BIPANA  THAPA MAGAR", regNo: "5903500137801007", dob: "2072-12-03", sex: "Female", gpa: "2.26875", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "4003", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4003", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4005", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "4009", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "4011", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "4013", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4013", type: "IN", om: "25", grade: "C+", gp: "2.4"}
        ]},
        { symbolNo: "8104008", name: "BISWASH B. K.", regNo: "5903500138001149", dob: "2074-05-12", sex: "Male", gpa: null, details: [
            { code: "4001", type: "TH", om: "4", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "4001", type: "IN", om: "38", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "6", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4003", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "4005", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4005", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "4007", type: "TH", om: "6", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "4007", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "4009", type: "TH", om: "4", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4009", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4011", type: "TH", om: "7", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4011", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4013", type: "IN", om: "24", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104009", name: "FIROJ SALMANI", regNo: "5903500137700741", dob: "2071-09-15", sex: "Male", gpa: null, details: [
            { code: "4001", type: "TH", om: "12", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "4001", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "11", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4003", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "4005", type: "TH", om: "8", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4005", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4007", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "10", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4009", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4011", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4011", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "4013", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4013", type: "IN", om: "21", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104010", name: "HIMANSH BK", regNo: "5903500137901043", dob: "2071-07-27", sex: "Male", gpa: "2.96875", details: [
            { code: "4001", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "4001", type: "IN", om: "46", grade: "A+", gp: "4"},
            { code: "4003", type: "TH", om: "29", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4003", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4005", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4005", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4007", type: "TH", om: "33", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4007", type: "IN", om: "46", grade: "A+", gp: "4"},
            { code: "4009", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4009", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4011", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "4011", type: "IN", om: "38", grade: "B+", gp: "3.2"},
            { code: "4013", type: "TH", om: "34", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "4013", type: "IN", om: "36", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8104011", name: "JAISARA KHATRI", regNo: "5903500137800961", dob: "2071-10-28", sex: "Female", gpa: "2.275", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "4003", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4003", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4005", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "C+", remarks: "" }, { code: "4013", type: "IN", om: "23", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104012", name: "JENISH SONI", regNo: "5903500137700680", dob: "2074-04-04", sex: "Male", gpa: "2.60625", details: [
            { code: "4001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "4003", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4005", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4007", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4009", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4011", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4013", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B", remarks: "" }, { code: "4013", type: "IN", om: "33", grade: "B", gp: "2.8"}
        ]},
        { symbolNo: "8104013", name: "KAJAL SUNAR", regNo: "5903500137700709", dob: "2072-08-21", sex: "Female", gpa: "2.20625", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "38", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4005", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4007", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4009", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "4011", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4011", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4013", type: "IN", om: "23", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104014", name: "KAMAL BC", regNo: "5903500137800963", dob: "2070-04-01", sex: "Male", gpa: null, details: [
            { code: "4001", type: "TH", om: "5", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4001", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "4003", type: "TH", om: "5", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4003", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "4005", type: "TH", om: "4", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4005", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "10", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4007", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4009", type: "TH", om: "2", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4009", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4011", type: "TH", om: "10", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4011", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4013", type: "TH", om: "13", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4013", type: "IN", om: "22", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104015", name: "KARAN  GHARTI", regNo: "5903500138001107", dob: "2071-10-01", sex: "Male", gpa: "2.8", details: [
            { code: "4001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "32", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "4003", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4005", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4005", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "4007", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4009", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4009", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4011", type: "TH", om: "36", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "4011", type: "IN", om: "39", grade: "B+", gp: "3.2"},
            { code: "4013", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "4013", type: "IN", om: "35", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8104016", name: "KIRISA  B. K.", regNo: "5903500138001104", dob: "2073-10-25", sex: "Female", gpa: "2.5125", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4005", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4007", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4009", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4009", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "34", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "4011", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "31", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "4013", type: "IN", om: "37", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8104017", name: "KRISHNA BASYAL", regNo: "5903500137700710", dob: "2072-09-01", sex: "Female", gpa: "2.13125", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4003", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4005", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4007", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4009", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "4011", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4011", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "4013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4013", type: "IN", om: "22", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104018", name: "KUSUM SUNAR", regNo: "5903500137700684", dob: "2073-03-20", sex: "Female", gpa: "2.475", details: [
            { code: "4001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4005", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "4007", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4007", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "4011", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "31", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "4013", type: "IN", om: "35", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8104019", name: "LAXMI B. K.", regNo: "5903500137700704", dob: "2070-11-22", sex: "Female", gpa: "2.21875", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4005", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4007", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4009", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "4011", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4013", type: "IN", om: "23", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104020", name: "MANJU  SUNAR ", regNo: "5903500138001129", dob: "2073-05-01", sex: "Female", gpa: null, details: [ // All NG
            { code: "4001", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4001", type: "IN", om: null, grade: null, gp: null},
            { code: "4003", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4003", type: "IN", om: null, grade: null, gp: null},
            { code: "4005", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4005", type: "IN", om: null, grade: null, gp: null},
            { code: "4007", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4007", type: "IN", om: null, grade: null, gp: null},
            { code: "4009", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4009", type: "IN", om: null, grade: null, gp: null},
            { code: "4011", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4011", type: "IN", om: null, grade: null, gp: null},
            { code: "4013", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4013", type: "IN", om: null, grade: null, gp: null}
        ]},
        { symbolNo: "8104021", name: "MANJUK BK", regNo: "5903500138001108", dob: "2072-01-20", sex: "Female", gpa: "3.10625", details: [
            { code: "4001", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "B+", remarks: "" }, { code: "4001", type: "IN", om: "47", grade: "A+", gp: "4"},
            { code: "4003", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4003", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "4005", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4005", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4007", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4007", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "4009", type: "TH", om: "29", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4009", type: "IN", om: "38", grade: "B+", gp: "3.2"},
            { code: "4011", type: "TH", om: "38", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "4011", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "4013", type: "TH", om: "29", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4013", type: "IN", om: "36", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8104022", name: "NEHA PARIYAR", regNo: "5903500137801004", dob: "2072-05-06", sex: "Female", gpa: "2.43125", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4005", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4009", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4013", type: "IN", om: "23", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104023", name: "NIKHIL  BK", regNo: "5903500137800990", dob: "2070-06-22", sex: "Male", gpa: "2.6875", details: [
            { code: "4001", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4001", type: "IN", om: "39", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4003", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4005", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4005", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "4007", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4007", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "4009", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4009", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4011", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "4011", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4013", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4013", type: "IN", om: "33", grade: "B", gp: "2.8"}
        ]},
        { symbolNo: "8104024", name: "PARBATI BK", regNo: "5903500137700707", dob: "2069-04-12", sex: "Female", gpa: null, details: [
            { code: "4001", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4001", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4003", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4003", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4005", type: "TH", om: "2", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4005", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4007", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "4009", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4009", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4011", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4011", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4013", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4013", type: "IN", om: "20", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104025", name: "PASUPATI BK", regNo: "5903500137700706", dob: "2072-10-26", sex: "Female", gpa: "2.4125", details: [
            { code: "4001", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4005", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "4007", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4009", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "4011", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "C+", remarks: "" }, { code: "4013", type: "IN", om: "24", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104026", name: "PRAMILA B. K.", regNo: "5903500137700739", dob: "2071-01-01", sex: "Female", gpa: "2.275", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4003", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4005", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4009", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "31", grade: "B", gp: "2.8", finalGrade: "C+", remarks: "" }, { code: "4013", type: "IN", om: "24", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104027", name: "PURNIMA BK", regNo: "5903500137700700", dob: "2073-09-08", sex: "Female", gpa: "2.175", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4003", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4005", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4009", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "4011", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4011", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "4013", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "4013", type: "IN", om: "24", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104028", name: "RIDAM  BK", regNo: "5903500137800992", dob: "2072-02-07", sex: "Male", gpa: "3.5625", details: [
            { code: "4001", type: "TH", om: "31", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4001", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "4003", type: "TH", om: "36", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "4003", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "4005", type: "TH", om: "41", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4005", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "4007", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "4007", type: "IN", om: "49", grade: "A+", gp: "4"},
            { code: "4009", type: "TH", om: "45", grade: "A+", gp: "4", finalGrade: "A", remarks: "" }, { code: "4009", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "4011", type: "TH", om: "45", grade: "A+", gp: "4", finalGrade: "B+", remarks: "" }, { code: "4011", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "4013", type: "TH", om: "37", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "4013", type: "IN", om: "40", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8104029", name: "ROMAN BISHWAKARMA", regNo: "5903500137700699", dob: "2073-06-08", sex: "Male", gpa: null, details: [
            { code: "4001", type: "TH", om: "7", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "4001", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "4003", type: "TH", om: "9", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4003", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4005", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "4007", type: "TH", om: "5", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "4007", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "5", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4009", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4011", type: "TH", om: "9", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "4011", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4013", type: "IN", om: "23", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104030", name: "RUPA BK", regNo: "5903500137700712", dob: "2072-09-19", sex: "Female", gpa: null, details: [ // All NG
            { code: "4001", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4001", type: "IN", om: null, grade: null, gp: null},
            { code: "4003", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4003", type: "IN", om: null, grade: null, gp: null},
            { code: "4005", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4005", type: "IN", om: null, grade: null, gp: null},
            { code: "4007", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4007", type: "IN", om: null, grade: null, gp: null},
            { code: "4009", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4009", type: "IN", om: null, grade: null, gp: null},
            { code: "4011", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4011", type: "IN", om: null, grade: null, gp: null},
            { code: "4013", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "4013", type: "IN", om: null, grade: null, gp: null}
        ]},
        { symbolNo: "8104031", name: "SAGAR GIRI", regNo: "5903500138001148", dob: "2072-08-04", sex: "Male", gpa: "2.4625", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "4003", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4003", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4005", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4007", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4009", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4013", type: "IN", om: "32", grade: "B", gp: "2.8"}
        ]},
        { symbolNo: "8104032", name: "SHISIR BK", regNo: "5903500137800956", dob: "2072-07-07", sex: "Male", gpa: "3.44375", details: [
            { code: "4001", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "4001", type: "IN", om: "47", grade: "A+", gp: "4"},
            { code: "4003", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "4003", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "4005", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4005", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "4007", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "4007", type: "IN", om: "49", grade: "A+", gp: "4"},
            { code: "4009", type: "TH", om: "43", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4009", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "4011", type: "TH", om: "41", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4011", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "4013", type: "TH", om: "34", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4013", type: "IN", om: "43", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8104033", name: "SITALA B. K.", regNo: "5903500137700756", dob: "2071-02-04", sex: "Female", gpa: "2.16875", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "4003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4003", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4005", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4007", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "4009", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4009", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4013", type: "IN", om: "23", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8104034", name: "SONU OLI", regNo: "5903500137700753", dob: "2069-07-21", sex: "Female", gpa: "2.60625", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "4003", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "4003", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "4005", type: "TH", om: "33", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4005", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "B", remarks: "" }, { code: "4007", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "4009", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4009", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "4011", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "4013", type: "IN", om: "26", grade: "C+", gp: "2.4"}
        ]},
        { symbolNo: "8104035", name: "TILAK  DANGI", regNo: "5903500138001112", dob: "2071-08-16", sex: "Male", gpa: "3.28125", details: [
            { code: "4001", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "4001", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "4003", type: "TH", om: "32", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4003", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "4005", type: "TH", om: "37", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "4005", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "4007", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4007", type: "IN", om: "49", grade: "A+", gp: "4"},
            { code: "4009", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "4009", type: "IN", om: "39", grade: "B+", gp: "3.2"},
            { code: "4011", type: "TH", om: "38", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "4011", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "4013", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "4013", type: "IN", om: "42", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8104036", name: "USIKA  BASYAL ", regNo: "5903500138001116", dob: "2070-03-17", sex: "Female", gpa: "3.78125", details: [
            { code: "4001", type: "TH", om: "42", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "4001", type: "IN", om: "49", grade: "A+", gp: "4"},
            { code: "4003", type: "TH", om: "47", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "4003", type: "IN", om: "46", grade: "A+", gp: "4"},
            { code: "4005", type: "TH", om: "36", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "4005", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "4007", type: "TH", om: "39", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "4007", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "4009", type: "TH", om: "46", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "4009", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "4011", type: "TH", om: "46", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "4011", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "4013", type: "TH", om: "45", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "4013", type: "IN", om: "46", grade: "A+", gp: "4"}
        ]},
        { symbolNo: "8104037", name: "YUBARAJ SUNAR", regNo: "5903500137700768", dob: "2070-09-16", sex: "Male", gpa: "1.98125", details: [
            { code: "4001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "4001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "4003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4003", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "4005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4005", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "4007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4007", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "4009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4009", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "4011", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "4011", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "4013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "4013", type: "IN", om: "23", grade: "C", gp: "2"}
        ]}
    ]; // End of studentGradeData Array

    // --- JAVASCRIPT LOGIC (Search, Display, Generate HTML) ---
    const symbolInput = document.getElementById('symbolInput');
    const searchButton = document.getElementById('searchButton');
    const resultArea = document.getElementById('resultArea');
    const gradeSheetContent = document.getElementById('gradeSheetContent');
    const errorMessage = document.getElementById('errorMessage');
    const printButton = document.getElementById('printButton');

    searchButton.addEventListener('click', displayGradeSheet);
    symbolInput.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') { displayGradeSheet(); }
    });

    function displayGradeSheet() {
        const enteredSymbol = symbolInput.value.trim();
        gradeSheetContent.innerHTML = '';
        errorMessage.innerHTML = '';
        resultArea.classList.add('hidden');
        printButton.style.display = 'none';

        if (!enteredSymbol) {
            errorMessage.textContent = 'Please enter a Symbol Number.';
            resultArea.classList.remove('hidden');
            gradeSheetContent.innerHTML = '';
            return;
        }

        const student = studentGradeData.find(s => s.symbolNo === enteredSymbol);

        if (student) {
             const hasOnlyNG = student.details && student.details.length > 0 && student.details.every(d => String(d.grade).toUpperCase() === 'NG' || d.grade === null || d.grade === undefined || d.grade === '');
             if (!student.details || student.details.length === 0 || hasOnlyNG) {
                 generateGradeSheetHTML(student); // Show basic info even if grades are NG
                 errorMessage.textContent = `No valid grade data available for Symbol Number "${enteredSymbol}". Student might be absent or data incomplete.`;
                 resultArea.classList.remove('hidden');
                 printButton.style.display = 'inline-block';
             } else {
                errorMessage.textContent = '';
                try {
                    generateGradeSheetHTML(student);
                    resultArea.classList.remove('hidden');
                    printButton.style.display = 'inline-block';
                } catch (error) {
                    console.error("Error generating grade sheet for symbol "+ enteredSymbol +":", error);
                    errorMessage.textContent = `An error occurred while generating the grade sheet for ${enteredSymbol}. Please check the browser console (F12) for details.`;
                    resultArea.classList.remove('hidden');
                    gradeSheetContent.innerHTML = '';
                }
             }
        } else {
            errorMessage.textContent = `Grade sheet for Symbol Number "${enteredSymbol}" not found.`;
            resultArea.classList.remove('hidden');
            gradeSheetContent.innerHTML = '';
        }
    }

    // Helper function to display grade/GP or N/A/NG safely
    function formatValue(value, isGpa = false, isCreditHour = false) {
        if (value === null || value === undefined || value === '') {
            return '<span class="na-text">N/A</span>';
        }
        const stringValue = String(value).toUpperCase();

        if (stringValue === 'NG') {
             return '<span class="na-text">NG</span>';
        }

        const numValue = parseFloat(value);

        if (!isNaN(numValue)) {
            if (isGpa) {
                 // Safely parse the student's GPA for formatting
                 const currentStudent = studentGradeData.find(s => s.symbolNo === symbolInput.value.trim()); // Find student again (or pass student as parameter)
                 const gpaNum = parseFloat(currentStudent?.gpa);
                 return !isNaN(gpaNum) ? gpaNum.toFixed(2) : '<span class="na-text">N/A</span>';
            } else if (isCreditHour) {
                 return numValue.toFixed(1); // Format Credit Hour
            } else {
                 // Format GP
                 return (numValue % 1 !== 0) ? numValue.toFixed(1) : numValue.toFixed(0);
            }
        }
        return value; // Return original string grade like A+, B
    }

    function generateGradeSheetHTML(student) {
        let gradeRows = '';
        if (student.details && student.details.length > 0) {
            for (let i = 0; i < student.details.length; i += 2) {
                const thDetail = student.details[i];
                const inDetail = (i + 1 < student.details.length && student.details[i+1].code === thDetail.code)
                                ? student.details[i + 1]
                                : { code: thDetail.code, type: 'IN', om: null, grade: null, gp: null }; // Dummy IN

                const subjectInfo = getSubjectDetails(thDetail.code);

                // Use the helper function for formatting all values
                const finalGradeValue = formatValue(thDetail.finalGrade);
                const remarksValue = thDetail.remarks || '';

                // TH Row
                gradeRows += `
                    <tr>
                        <td>${thDetail.code || ''}</td>
                        <td>${subjectInfo.thName || 'N/A'}</td>
                        <td>${formatValue(subjectInfo.thCrHr, false, true)}</td>
                        <td>${formatValue(thDetail.gp)}</td>
                        <td>${formatValue(thDetail.grade)}</td>
                        <td class="final-grade-cell" rowspan="2">${finalGradeValue}</td>
                        <td class="remarks-cell" rowspan="2">${remarksValue}</td>
                    </tr>
                `;
                // IN Row
                gradeRows += `
                     <tr>
                         <td>${inDetail.code || ''}</td>
                         <td>${subjectInfo.inName || 'N/A'}</td>
                         <td>${formatValue(subjectInfo.inCrHr, false, true)}</td>
                         <td>${formatValue(inDetail.gp)}</td>
                         <td>${formatValue(inDetail.grade)}</td>
                         <!-- Final Grade & Remarks covered by rowspan -->
                     </tr>
                 `;
            }
        } else {
            gradeRows = '<tr><td colspan="7" style="text-align: center;">No grade details available.</td></tr>';
        }

        // Get the GPA display string using the helper function
        const gpaDisplay = formatValue(student.gpa, true);

        const gradeSheetHTML = `
            <div class="gradesheet-container">
                <div class="header">
                    <h1>${schoolInfo.name}</h1>
                    <p>${schoolInfo.address}</p>
                    <p class="title">GRADE-SHEET</p>
                    <p>GRADE - ${schoolInfo.gradeLevel} | YEAR ${schoolInfo.year}</p> <!-- Corrected Class -->
                </div>
                <div class="student-info">
                     <div class="info-grid">
                         <div class="info-item"><span>Name:</span> ${student.name || '<span class="na-text">N/A</span>'}</div>
                         <div class="info-item"><span>Symbol No:</span> ${student.symbolNo || '<span class="na-text">N/A</span>'}</div>
                         <div class="info-item"><span>Reg No:</span> ${student.regNo || '<span class="na-text">N/A</span>'}</div>
                         <div class="info-item"><span>Date of Birth:</span> ${student.dob || '<span class="na-text">N/A</span>'}</div>
                         <div class="info-item"><span>Sex:</span> ${student.sex || '<span class="na-text">N/A</span>'}</div>
                     </div>
                 </div>
                <div class="table-wrapper">
                    <table class="grades-table">
                         <thead>
                             <tr>
                                 <th>SUBJECT CODE</th>
                                 <th>SUBJECTS</th>
                                 <th>CREDIT HOUR</th>
                                 <th>GRADE POINT</th>
                                 <th>GRADE</th>
                                 <th>FINAL GRADE</th>
                                 <th>REMARKS</th>
                             </tr>
                         </thead>
                        <tbody>
                            ${gradeRows}
                        </tbody>
                    </table>
                </div>
                <div class="gpa-section">
                     GRADE POINT AVERAGE (GPA): ${gpaDisplay}
                    ${(gpaDisplay.includes('N/A') || gpaDisplay.includes('NG')) ? '<br><span style="font-size:0.8em; color: #666;">(GPA not calculated or unavailable)</span>' : ''}
                </div>
                <!-- Footer Notes (EXACTLY From 2080 Sample) -->
                <div class="footer-notes">
                    <p>* This Gradesheet is for Information Purpose Only.</p>
                    <p>* TH = Theory Grade, IN = Internal Grade, FINAL = Final Subject Grade.</p>
                    <p>* NG = Not Graded (May indicate absence or incomplete data). N/A = Not Available.</p>
                 </div>
            </div>
        `;
        gradeSheetContent.innerHTML = gradeSheetHTML;
    }

    // Print Function (From 2080 Sample)
    function printGradeSheet() {
        window.print();
    }

</script>

</body>
</html>