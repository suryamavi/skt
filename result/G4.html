<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>SURYA JYOTI SECONDARY SCHOOL - GRADE SHEET</title><script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><style>body{font-family:Calibri,'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;margin:0;padding:0;background-color:#f0f2f5;color:#333;line-height:1.5;font-size:10.5pt}.search-form-container{width:800px;margin:20px auto;padding:20px;background-color:#fff;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.1);text-align:center}.search-form-container h2{margin-top:0;color:#004a99;font-size:14pt;text-transform:uppercase}.search-form-container label{font-weight:600;margin-right:10px;text-transform:uppercase}.search-form-container input[type=text]{padding:8px 12px;font-size:11pt;border:1px solid #ccc;border-radius:4px;width:200px;margin-right:10px}.search-form-container button[type=submit]{padding:8px 20px;font-size:11pt;font-weight:600;background-color:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;transition:background-color .2s ease;text-transform:uppercase}.search-form-container button[type=submit]:hover{background-color:#0056b3}.error-message{color:#d8000c;background-color:#ffd2d2;border:1px solid #d8000c;padding:10px;margin-top:15px;border-radius:4px;text-align:center}.gradesheet-container{width:210mm;min-height:270mm;margin:25px auto;padding:15mm;background-color:#fff;border:1px solid #ccc;box-shadow:0 5px 20px rgba(0,0,0,.1);box-sizing:border-box;position:relative;display:none}.header{display:flex;align-items:center;padding-bottom:15px;margin-bottom:20px;border-bottom:3px solid #0056b3}.header .logo{width:70px;height:70px;flex-shrink:0;margin-right:15px}.header .logo img{max-width:100%;max-height:100%;display:block}.header .title{text-align:center;flex-grow:1;color:#003366}.header .title h1,.header .title h2,.header .title h3,.header .title h4,.header .title h5{margin:1px 0;font-weight:700;color:#0056b3;text-transform:uppercase}.header .title h1{font-size:18pt;font-weight:700;letter-spacing:1px}.header .title h2{font-size:11pt}.header .title h3{font-size:10pt;font-weight:400}.header .title h4{font-size:12pt;margin-top:5px}.header .title h5{font-size:14pt;letter-spacing:1px}.student-info{margin-bottom:20px;padding:12px 15px;background-color:#f8fbff;border:1px solid #d6e7f9;border-radius:5px;font-size:10.5pt}.student-info table{width:100%;border-collapse:collapse}.student-info td{padding:3px 5px;vertical-align:top}.student-info td.label{font-weight:600;color:#004085;width:130px;white-space:nowrap}.student-info td.value{font-weight:400}.dotted-line,.separator{display:none}.grades-table{width:100%;border-collapse:collapse;margin-bottom:20px;font-size:9pt;border:1.5pt solid #004a99}.grades-table td,.grades-table th{padding:5px 7px;text-align:left;vertical-align:middle;border-top:.5pt solid #d0d9e3;border-bottom:.5pt solid #d0d9e3;border-left:1pt solid #a8b8c8;border-right:1pt solid #a8b8c8}.grades-table td:first-child,.grades-table th:first-child{border-left:none}.grades-table td:last-child,.grades-table th:last-child{border-right:none}.grades-table thead th{background:linear-gradient(to bottom,#f0f6fc,#d9e6f5);color:#003366;font-weight:600;text-align:center;font-size:9.5pt;padding:7px;text-transform:uppercase;border-bottom:1pt solid #a8b8c8;border-top:none}.grades-table td:nth-child(1),.grades-table td:nth-child(3),.grades-table td:nth-child(4),.grades-table td:nth-child(5),.grades-table td:nth-child(6){text-align:center}.grades-table tbody tr:nth-child(2n){background-color:#fafdff}.grades-table td.final-grade{font-weight:700;vertical-align:middle;text-align:center}.grades-table tfoot td{font-weight:700;background-color:#eef4fa;text-align:right;padding:6px 12px;font-size:10pt;color:#003366;border-top:1pt solid #a8b8c8;border-bottom:none}.grades-table tfoot td:nth-child(2){font-weight:700;text-align:center}.notes{font-size:9pt;color:#444;line-height:1.4;padding:12px 15px;background-color:#f9f9f9;border:1px solid #e5e5e5;border-radius:5px}.notes strong{color:#000}.notes h4{margin:0 0 6px;font-size:10pt;font-weight:600;color:#333;text-transform:uppercase}.notes ul{list-style:none;padding-left:0;margin:0}.notes ul li{display:inline-block;margin-right:12px;white-space:nowrap}.action-buttons{text-align:center;margin:30px 0 10px;display:none}.action-buttons button{padding:10px 25px;font-size:12pt;font-weight:600;color:#fff;border:none;border-radius:5px;cursor:pointer;transition:background-color .2s ease,box-shadow .2s ease;box-shadow:0 2px 5px rgba(0,0,0,.15);text-transform:uppercase;margin:0 10px}#printButton{background-color:#28a745}#printButton:hover{background-color:#218838}#savePngButton{background-color:#ffc107;color:#333}#savePngButton:hover{background-color:#e0a800}.hide-for-png{display:none!important;visibility:hidden!important}@page{size:A4;margin:12mm}@media print{body{font-family:Arial,sans-serif;font-size:9pt;background-color:#fff;margin:0;padding:0;color:#000!important}.gradesheet-container{width:100%;min-height:initial;margin:0;padding:0;border:none!important;box-shadow:none!important;display:block!important}.noprint,.search-form-container,.action-buttons,.disclaimer,.hide-for-png{display:none!important}hr.separator{display:none!important}.header,.student-info,.grades,.notes{page-break-inside:avoid;margin-bottom:6mm!important;padding:4mm!important;border:.75pt solid #e0e0e0!important;background-color:#fdfdfd!important;border-radius:3px}.header{border:none!important;background-color:transparent!important;padding:0 0 4mm!important;margin-bottom:4mm!important;border-bottom:1pt solid #999!important;border-radius:0}.grades{padding:0!important;border:none!important;background-color:transparent!important;margin-bottom:6mm!important}.notes{border:.75pt solid #e0e0e0!important;background-color:#fdfdfd!important;padding:4mm!important;margin-top:5mm!important;margin-bottom:0!important}.header .title h1{font-size:14pt!important;white-space:nowrap}.header .title h2{font-size:10pt!important}.header .title h3{font-size:9pt!important}.header .title h4{font-size:11pt!important}.header .title h5{font-size:13pt!important}.student-info{font-size:9pt!important}.student-info table{width:100%}.student-info td{padding:1px 3px!important;vertical-align:top!important}.student-info td.label{color:#000!important;font-weight:700!important;width:auto!important;white-space:nowrap;padding-right:5px!important}.student-info td.value{font-weight:700!important;border-bottom:none!important}.dotted-line{display:none!important}.grades-table{border:1pt solid #bbb!important;font-size:8.5pt!important;margin-bottom:0!important}.grades-table td,.grades-table th{border:.5pt solid #ccc!important;padding:2.5px 4px!important}.grades-table thead th{background-color:#ededed!important;color:#000!important;font-size:8.5pt!important;font-weight:700!important;border-bottom:1pt solid #aaa!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.grades-table tfoot td{background-color:#f0f0f0!important;font-size:9.5pt!important;color:#000!important;border-top:1pt solid #aaa!important;-webkit-print-color-adjust:exact;print-color-adjust:exact}.grades-table tfoot td:nth-child(2){font-weight:700!important}.grades-table tbody tr:nth-child(2n){background-color:transparent!important}.notes h4{font-size:9pt!important}.notes ul li{margin-right:10px!important}*{background-color:transparent!important;box-shadow:none!important;text-shadow:none!important;color:#000!important}a{text-decoration:none}img{max-width:100%!important}}.generating-png{border:none!important;box-shadow:none!important;padding:12mm!important;background-color:#fff!important}.generating-png .header,.generating-png .student-info,.generating-png .grades,.generating-png .notes{margin-bottom:6mm!important;padding:4mm!important;border:.75pt solid #e0e0e0!important;background-color:#fdfdfd!important;border-radius:3px}.generating-png .header{border:none!important;background-color:transparent!important;padding:0 0 4mm!important;margin-bottom:4mm!important;border-bottom:1pt solid #999!important;border-radius:0}.generating-png .hide-for-png{display:none!important;visibility:hidden!important}.generating-png .grades{padding:0!important;border:none!important;background-color:transparent!important;margin-bottom:6mm!important}.generating-png .notes{border:.75pt solid #e0e0e0!important;background-color:#fdfdfd!important;padding:4mm!important;margin-top:5mm!important;margin-bottom:0!important}.generating-png .student-info{border:.75pt solid #e0e0e0!important;background-color:#fdfdfd!important}.generating-png .grades-table{border:1pt solid #bbb!important}.generating-png .grades-table td,.generating-png .grades-table th{border:.5pt solid #ccc!important}.generating-png .grades-table thead th{background-color:#ededed!important;color:#000!important;border-bottom:1pt solid #aaa!important}.generating-png .grades-table tfoot td{background-color:#f0f0f0!important;color:#000!important;border-top:1pt solid #aaa!important}.generating-png .student-info td.label{color:#000!important}.generating-png *{font-family:Arial,sans-serif!important;color:#000!important;background-color:transparent!important}</style></head><body><div class="search-form-container noprint"><h2>VIEW GRADE SHEET</h2><form id="searchForm"><label for="symbol">SYMBOL NUMBER:</label><input type="text" id="symbol" name="symbol" placeholder="Enter Symbol No." required><button type="submit">SEARCH</button></form><div class="error-message" style="display: none;"></div></div><div class="gradesheet-container" id="gradesheetResult"></div><div class="action-buttons noprint" id="actionButtonsDiv"><button id="printButton" onclick="window.print()">PRINT GRADE SHEET</button><button id="savePngButton">SAVE AS PNG</button></div><script>// --- Subject Details ---
const subjectDetails = {
    "4001": {
        "name": "COM.  ENGLISH",
        "th_crhr": 2.5,
        "in_crhr": 2.5
    },
    "4003": {
        "name": "COM.  NEPALI",
        "th_crhr": 2.5,
        "in_crhr": 2.5
    },
    "4005": {
        "name": "COM.  MATHEMATICS",
        "th_crhr": 2.5,
        "in_crhr": 2.5
    },
    "4007": {
        "name": "COM. SCIENCE & TECHNOLOGY",
        "th_crhr": 2.5,
        "in_crhr": 2.5
    },
    "4009": {
        "name": "COM.  SOCIAL STUDIES AND LIFE SKILL EDU.",
        "th_crhr": 2.5,
        "in_crhr": 2.5
    },
    "4011": {
        "name": "HEALTH PHY. & CREATIVE ARTS",
        "th_crhr": 1.5,
        "in_crhr": 1.5
    },
    "4013": {
        "name": "HAMRO GURBHAKOT",
        "th_crhr": 2,
        "in_crhr": 2
    }
};
// --- Student Data ---
const allStudentsData = {
    "8104001": {
        "name": "AADITYA CHUNARA",
        "roll": "1",
        "reg_no": "5903500048003231",
        "dob": "2071-06-29",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 3.3875,
        "subjects": {
            "4001": [
                "B",
                2.8,
                "A+",
                4,
                "B+"
            ],
            "4003": [
                "B",
                2.8,
                "A",
                3.6,
                "B+"
            ],
            "4005": [
                "B",
                2.8,
                "A+",
                4,
                "B+"
            ],
            "4007": [
                "A",
                3.6,
                "A+",
                4,
                "A"
            ],
            "4009": [
                "C+",
                2.4,
                "A",
                3.6,
                "B"
            ],
            "4011": [
                "A",
                3.6,
                "A",
                3.6,
                "A"
            ],
            "4013": [
                "B+",
                3.2,
                "A",
                3.6,
                "B+"
            ]
        }
    },
    "8104002": {
        "name": "AASHIS  KHADKA",
        "roll": "2",
        "reg_no": "5903500138001114",
        "dob": "2073-01-22",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.40625,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "A",
                3.6,
                "C+"
            ],
            "4003": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4005": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4007": [
                "D",
                1.6,
                "A",
                3.6,
                "C+"
            ],
            "4009": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4011": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ]
        }
    },
    "8104003": {
        "name": "ABHISEK KUMAI",
        "roll": "3",
        "reg_no": "5903500048003232",
        "dob": "2072-04-01",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 0,
        "subjects": {
            "4001": [
                "NG",
                0,
                "B",
                2.8,
                "NG"
            ],
            "4003": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4005": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4007": [
                "NG",
                0,
                "B+",
                3.2,
                "D"
            ],
            "4009": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4011": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4013": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ]
        }
    },
    "8104004": {
        "name": "ABINA NEPALI",
        "roll": "4",
        "reg_no": "5903500137901045",
        "dob": "2070-11-28",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.3375,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4003": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4005": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4007": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4009": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4011": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ]
        }
    },
    "8104005": {
        "name": "ABINAM BK",
        "roll": "5",
        "reg_no": "5903500137800952",
        "dob": "2071-12-19",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 3.66875,
        "subjects": {
            "4001": [
                "C+",
                2.4,
                "A+",
                4,
                "B+"
            ],
            "4003": [
                "A",
                3.6,
                "A+",
                4,
                "A"
            ],
            "4005": [
                "A",
                3.6,
                "A+",
                4,
                "A"
            ],
            "4007": [
                "A",
                3.6,
                "A+",
                4,
                "A"
            ],
            "4009": [
                "A",
                3.6,
                "A",
                3.6,
                "A"
            ],
            "4011": [
                "A+",
                4,
                "A+",
                4,
                "A+"
            ],
            "4013": [
                "B+",
                3.2,
                "A+",
                4,
                "A"
            ]
        }
    },
    "8104006": {
        "name": "ANUJA YARI",
        "roll": "6",
        "reg_no": "5903500137700760",
        "dob": "2070-05-04",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.2375,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4005": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ],
            "4007": [
                "D",
                1.6,
                "A",
                3.6,
                "C+"
            ],
            "4009": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4011": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4013": [
                "C+",
                2.4,
                "C+",
                2.4,
                "C+"
            ]
        }
    },
    "8104007": {
        "name": "BIPANA  THAPA MAGAR",
        "roll": "7",
        "reg_no": "5903500137801007",
        "dob": "2072-12-03",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.26875,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "A",
                3.6,
                "C+"
            ],
            "4003": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4005": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4007": [
                "D",
                1.6,
                "A",
                3.6,
                "C+"
            ],
            "4009": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4011": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4013": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ]
        }
    },
    "8104008": {
        "name": "BISWASH B. K.",
        "roll": "8",
        "reg_no": "5903500138001149",
        "dob": "2074-05-12",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 0,
        "subjects": {
            "4001": [
                "NG",
                0,
                "B+",
                3.2,
                "D"
            ],
            "4003": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4005": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4007": [
                "NG",
                0,
                "A",
                3.6,
                "D"
            ],
            "4009": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4011": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4013": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ]
        }
    },
    "8104009": {
        "name": "FIROJ SALMANI",
        "roll": "9",
        "reg_no": "5903500137700741",
        "dob": "2071-09-15",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 0,
        "subjects": {
            "4001": [
                "NG",
                0,
                "B+",
                3.2,
                "D"
            ],
            "4003": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4005": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4007": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4009": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4011": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4013": [
                "C",
                2,
                "C",
                2,
                "C"
            ]
        }
    },
    "8104010": {
        "name": "HIMANSH BK",
        "roll": "10",
        "reg_no": "5903500137901043",
        "dob": "2071-07-27",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.96875,
        "subjects": {
            "4001": [
                "C",
                2,
                "A+",
                4,
                "B"
            ],
            "4003": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4005": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4007": [
                "B",
                2.8,
                "A+",
                4,
                "B+"
            ],
            "4009": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4011": [
                "B",
                2.8,
                "B+",
                3.2,
                "B"
            ],
            "4013": [
                "B",
                2.8,
                "B+",
                3.2,
                "B"
            ]
        }
    },
    "8104011": {
        "name": "JAISARA KHATRI",
        "roll": "11",
        "reg_no": "5903500137800961",
        "dob": "2071-10-28",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.275,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "A",
                3.6,
                "C+"
            ],
            "4003": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4005": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ],
            "4007": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4009": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4011": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "B",
                2.8,
                "C",
                2,
                "C+"
            ]
        }
    },
    "8104012": {
        "name": "JENISH SONI",
        "roll": "12",
        "reg_no": "5903500137700680",
        "dob": "2074-04-04",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.60625,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "A",
                3.6,
                "C+"
            ],
            "4003": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4005": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4007": [
                "C",
                2,
                "B+",
                3.2,
                "C+"
            ],
            "4009": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4011": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4013": [
                "B+",
                3.2,
                "B",
                2.8,
                "B"
            ]
        }
    },
    "8104013": {
        "name": "KAJAL SUNAR",
        "roll": "13",
        "reg_no": "5903500137700709",
        "dob": "2072-08-21",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.20625,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4005": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4007": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4009": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4011": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4013": [
                "C",
                2,
                "C",
                2,
                "C"
            ]
        }
    },
    "8104014": {
        "name": "KAMAL BC",
        "roll": "14",
        "reg_no": "5903500137800963",
        "dob": "2070-04-01",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 0,
        "subjects": {
            "4001": [
                "NG",
                0,
                "B",
                2.8,
                "NG"
            ],
            "4003": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4005": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4007": [
                "NG",
                0,
                "B",
                2.8,
                "NG"
            ],
            "4009": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4011": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4013": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ]
        }
    },
    "8104015": {
        "name": "KARAN  GHARTI",
        "roll": "15",
        "reg_no": "5903500138001107",
        "dob": "2071-10-01",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.8,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "B",
                2.8,
                "B+",
                3.2,
                "B"
            ],
            "4005": [
                "C+",
                2.4,
                "A",
                3.6,
                "B"
            ],
            "4007": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4009": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4011": [
                "B+",
                3.2,
                "B+",
                3.2,
                "B+"
            ],
            "4013": [
                "B",
                2.8,
                "B+",
                3.2,
                "B"
            ]
        }
    },
    "8104016": {
        "name": "KIRISA  B. K.",
        "roll": "16",
        "reg_no": "5903500138001104",
        "dob": "2073-10-25",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.5125,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4005": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4007": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4009": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4011": [
                "B",
                2.8,
                "B",
                2.8,
                "B"
            ],
            "4013": [
                "B",
                2.8,
                "B+",
                3.2,
                "B"
            ]
        }
    },
    "8104017": {
        "name": "KRISHNA BASYAL",
        "roll": "17",
        "reg_no": "5903500137700710",
        "dob": "2072-09-01",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.13125,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4005": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4007": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4009": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4011": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4013": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ]
        }
    },
    "8104018": {
        "name": "KUSUM SUNAR",
        "roll": "18",
        "reg_no": "5903500137700684",
        "dob": "2073-03-20",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.475,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4005": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4007": [
                "B",
                2.8,
                "B+",
                3.2,
                "B"
            ],
            "4009": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4011": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "B",
                2.8,
                "B+",
                3.2,
                "B"
            ]
        }
    },
    "8104019": {
        "name": "LAXMI B. K.",
        "roll": "19",
        "reg_no": "5903500137700704",
        "dob": "2070-11-22",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.21875,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "C",
                2,
                "B+",
                3.2,
                "C+"
            ],
            "4005": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ],
            "4007": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4009": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4011": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ]
        }
    },
    "8104020": {
        "name": "MANJU  SUNAR",
        "roll": "20",
        "reg_no": "5903500138001129",
        "dob": "2073-05-01",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 0,
        "subjects": {
            "4001": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4003": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4005": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4007": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4009": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4011": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4013": [
                "",
                0,
                "",
                0,
                "NG"
            ]
        }
    },
    "8104021": {
        "name": "MANJUK BK",
        "roll": "21",
        "reg_no": "5903500138001108",
        "dob": "2072-01-20",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 3.10625,
        "subjects": {
            "4001": [
                "C+",
                2.4,
                "A+",
                4,
                "B+"
            ],
            "4003": [
                "B",
                2.8,
                "A",
                3.6,
                "B+"
            ],
            "4005": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4007": [
                "A",
                3.6,
                "A",
                3.6,
                "A"
            ],
            "4009": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4011": [
                "B+",
                3.2,
                "A",
                3.6,
                "B+"
            ],
            "4013": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ]
        }
    },
    "8104022": {
        "name": "NEHA PARIYAR",
        "roll": "22",
        "reg_no": "5903500137801004",
        "dob": "2072-05-06",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.43125,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4005": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4007": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4009": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4011": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "C",
                2,
                "C",
                2,
                "C"
            ]
        }
    },
    "8104023": {
        "name": "NIKHIL  BK",
        "roll": "23",
        "reg_no": "5903500137800990",
        "dob": "2070-06-22",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.6875,
        "subjects": {
            "4001": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4003": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4005": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4007": [
                "C+",
                2.4,
                "A",
                3.6,
                "B"
            ],
            "4009": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4011": [
                "C+",
                2.4,
                "B+",
                3.2,
                "B"
            ],
            "4013": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ]
        }
    },
    "8104024": {
        "name": "PARBATI BK",
        "roll": "24",
        "reg_no": "5903500137700707",
        "dob": "2069-04-12",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 0,
        "subjects": {
            "4001": [
                "NG",
                0,
                "B",
                2.8,
                "NG"
            ],
            "4003": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4005": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4007": [
                "NG",
                0,
                "C+",
                2.4,
                "NG"
            ],
            "4009": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4011": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4013": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ]
        }
    },
    "8104025": {
        "name": "PASUPATI BK",
        "roll": "25",
        "reg_no": "5903500137700706",
        "dob": "2072-10-26",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.4125,
        "subjects": {
            "4001": [
                "C",
                2,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4005": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4007": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4009": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4011": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "B+",
                3.2,
                "C",
                2,
                "C+"
            ]
        }
    },
    "8104026": {
        "name": "PRAMILA B. K.",
        "roll": "26",
        "reg_no": "5903500137700739",
        "dob": "2071-01-01",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.275,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4005": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ],
            "4007": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4009": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4011": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "B",
                2.8,
                "C",
                2,
                "C+"
            ]
        }
    },
    "8104027": {
        "name": "PURNIMA BK",
        "roll": "27",
        "reg_no": "5903500137700700",
        "dob": "2073-09-08",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.175,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4005": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ],
            "4007": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4009": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4011": [
                "C",
                2,
                "C+",
                2.4,
                "C"
            ],
            "4013": [
                "C",
                2,
                "C",
                2,
                "C"
            ]
        }
    },
    "8104028": {
        "name": "RIDAM  BK",
        "roll": "28",
        "reg_no": "5903500137800992",
        "dob": "2072-02-07",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 3.5625,
        "subjects": {
            "4001": [
                "B",
                2.8,
                "A",
                3.6,
                "B+"
            ],
            "4003": [
                "B+",
                3.2,
                "A+",
                4,
                "A"
            ],
            "4005": [
                "A",
                3.6,
                "A",
                3.6,
                "A"
            ],
            "4007": [
                "B+",
                3.2,
                "A+",
                4,
                "A"
            ],
            "4009": [
                "A+",
                4,
                "A",
                3.6,
                "A"
            ],
            "4011": [
                "A+",
                4,
                "A",
                3.6,
                "A"
            ],
            "4013": [
                "B+",
                3.2,
                "A",
                3.6,
                "B+"
            ]
        }
    },
    "8104029": {
        "name": "ROMAN BISHWAKARMA",
        "roll": "29",
        "reg_no": "5903500137700699",
        "dob": "2073-06-08",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 0,
        "subjects": {
            "4001": [
                "NG",
                0,
                "A",
                3.6,
                "D"
            ],
            "4003": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4005": [
                "D",
                1.6,
                "C+",
                2.4,
                "C"
            ],
            "4007": [
                "NG",
                0,
                "B+",
                3.2,
                "D"
            ],
            "4009": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4011": [
                "NG",
                0,
                "C",
                2,
                "NG"
            ],
            "4013": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ]
        }
    },
    "8104030": {
        "name": "RUPA BK",
        "roll": "30",
        "reg_no": "5903500137700712",
        "dob": "2072-09-19",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 0,
        "subjects": {
            "4001": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4003": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4005": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4007": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4009": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4011": [
                "",
                0,
                "",
                0,
                "NG"
            ],
            "4013": [
                "",
                0,
                "",
                0,
                "NG"
            ]
        }
    },
    "8104031": {
        "name": "SAGAR GIRI",
        "roll": "31",
        "reg_no": "5903500138001148",
        "dob": "2072-08-04",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.4625,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "A",
                3.6,
                "C+"
            ],
            "4003": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4005": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4007": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4009": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4011": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ]
        }
    },
    "8104032": {
        "name": "SHISIR BK",
        "roll": "32",
        "reg_no": "5903500137800956",
        "dob": "2072-07-07",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 3.44375,
        "subjects": {
            "4001": [
                "C",
                2,
                "A+",
                4,
                "B"
            ],
            "4003": [
                "B+",
                3.2,
                "A",
                3.6,
                "B+"
            ],
            "4005": [
                "A",
                3.6,
                "A",
                3.6,
                "A"
            ],
            "4007": [
                "B+",
                3.2,
                "A+",
                4,
                "A"
            ],
            "4009": [
                "A",
                3.6,
                "A",
                3.6,
                "A"
            ],
            "4011": [
                "A",
                3.6,
                "A+",
                4,
                "A"
            ],
            "4013": [
                "B",
                2.8,
                "A",
                3.6,
                "B+"
            ]
        }
    },
    "8104033": {
        "name": "SITALA B. K.",
        "roll": "33",
        "reg_no": "5903500137700756",
        "dob": "2071-02-04",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.16875,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "B+",
                3.2,
                "C+"
            ],
            "4003": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4005": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ],
            "4007": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4009": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4011": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "D",
                1.6,
                "C",
                2,
                "D"
            ]
        }
    },
    "8104034": {
        "name": "SONU OLI",
        "roll": "34",
        "reg_no": "5903500137700753",
        "dob": "2069-07-21",
        "dob_ad": "",
        "sex": "Female",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 2.60625,
        "subjects": {
            "4001": [
                "D",
                1.6,
                "A",
                3.6,
                "C+"
            ],
            "4003": [
                "D",
                1.6,
                "B",
                2.8,
                "C"
            ],
            "4005": [
                "B",
                2.8,
                "A",
                3.6,
                "B+"
            ],
            "4007": [
                "D",
                1.6,
                "A+",
                4,
                "B"
            ],
            "4009": [
                "C",
                2,
                "B",
                2.8,
                "C+"
            ],
            "4011": [
                "C+",
                2.4,
                "B",
                2.8,
                "C+"
            ],
            "4013": [
                "C+",
                2.4,
                "C+",
                2.4,
                "C+"
            ]
        }
    },
    "8104035": {
        "name": "TILAK  DANGI",
        "roll": "35",
        "reg_no": "5903500138001112",
        "dob": "2071-08-16",
        "dob_ad": "",
        "sex": "Male",
        "grade_level": "4",
        "exam_year_bs": "2081",
        "gpa": 3.28125,
        "subjects": {
            "4001": [
                "C",
                2,
                "A+",
                4,
                "B"
            ],
            "4003": [
                "B",
                2.8,
                "A",
                3.6,
                "B+"
            ],
            "4005": [
                "B+",
                3.2,
                "A",
                3.6,
                "B+"
            ],
            "4007": [
                "A",
                3.6,
                "A+",
                4,
                "A"
            ],
            "4009": [
                "B",
                2.8,
                "B+",
                3.2,
                "B"
            ],
            "4011": [
                "B+",
                3.2,
                "A",
                3.6,
                "B+"
            ],
            "4013": [
                "B",
                2.8,
                "A",
                3.6,
                "B+"
            ]
        }
    }
};
// --- Function to Generate Grade Sheet HTML ---
function generateGradeSheetHTML(symbol, student) { if (!student || typeof student !== 'object' || !student.name || !student.subjects || typeof student.subjects !== 'object') { console.error(`Invalid student data for symbol: ${symbol}`, student); return '<p style="color:red; text-align:center; padding:20px;">Error: Invalid student data structure.</p>'; } const gpaValue = (student.gpa !== undefined && student.gpa !== null && !isNaN(parseFloat(student.gpa))) ? parseFloat(student.gpa).toFixed(2) : 'N/A'; const studentInfoHTML = `<table><tr><td class="label">Student's Name:</td><td class="value">${student.name}<span class="dotted-line"></span></td><td class="label">Symbol No:</td><td class="value">${symbol}<span class="dotted-line"></span></td></tr><tr><td class="label">Registration No:</td><td class="value">${student.reg_no || 'N/A'}<span class="dotted-line"></span></td><td class="label">Date of Birth:</td><td class="value">${student.dob || 'N/A'}<span class="dotted-line"></span></td></tr><tr><td class="label">Grade:</td><td class="value">${student.grade_level || 'N/A'}<span class="dotted-line"></span></td><td class="label">Gender:</td><td class="value">${student.sex || 'N/A'}<span class="dotted-line"></span></td></tr></table>`; let tableRowsHTML = ''; const subjectKeys = typeof student.subjects === 'object' && student.subjects !== null ? Object.keys(student.subjects) : []; const sortedSubjectCodes = subjectKeys.sort(); if (sortedSubjectCodes.length === 0) { tableRowsHTML = '<tr><td colspan="7" style="text-align:center; color:grey;">No subject data available.</td></tr>'; } else { for (const th_code of sortedSubjectCodes) { if (subjectDetails[th_code] && Array.isArray(student.subjects[th_code]) && student.subjects[th_code].length >= 5) { const details = subjectDetails[th_code]; const grades = student.subjects[th_code]; const in_code = String(parseInt(th_code) + 1).padStart(4, '0'); const th_grade = grades[0] || ''; const th_gp = grades[1] !== undefined && !isNaN(parseFloat(grades[1])) ? parseFloat(grades[1]).toFixed(1) : 'N/A'; const in_grade = grades[2] || ''; const in_gp = grades[3] !== undefined && !isNaN(parseFloat(grades[3])) ? parseFloat(grades[3]).toFixed(1) : 'N/A'; const final_grade = grades[4] || ''; const th_cr_hr_display = (details.th_crhr !== undefined && !isNaN(details.th_crhr)) ? details.th_crhr.toFixed(2) : 'N/A'; const in_cr_hr_display = (details.in_crhr !== undefined && !isNaN(details.in_crhr)) ? details.in_crhr.toFixed(2) : 'N/A'; const subject_name_display = details.name || 'Unknown Subject'; tableRowsHTML += `<tr><td>${th_code}</td><td>${subject_name_display} (TH)</td><td>${th_cr_hr_display}</td><td>${th_gp}</td><td>${th_grade}</td><td rowspan="2" class="final-grade">${final_grade}</td><td rowspan="2"></td></tr><tr><td>${in_code}</td><td>${subject_name_display} (IN)</td><td>${in_cr_hr_display}</td><td>${in_gp}</td><td>${in_grade}</td></tr>`; } else { console.warn(`Skipping subject code ${th_code} for symbol ${symbol} due to missing details or invalid grades array.`, student.subjects[th_code]); tableRowsHTML += `<tr><td>${th_code}</td><td colspan="6" style="text-align:center; color:grey;">Subject details missing or data invalid</td></tr>`; } } } const gradeSheetHTML = `<header class="header"><div class="logo" id="schoolLogo"><img src="school_logo.png" alt="School Logo"></div><div class="title"><h1>SURYA JYOTI SECONDARY SCHOOL MEHELKUNA</h1><h2>GURBHAKOT MUNICIPALITY-08, SURKHET</h2><h3>KARNALI PROVINCE, NEPAL</h3><h4>FINAL EXAMINATION - 2081 B.S.</h4><h5>GRADE SHEET</h5></div></header><section class="student-info">${studentInfoHTML}</section><section class="grades"><table class="grades-table"><thead><tr><th rowspan="2">SUBJECT CODE</th><th rowspan="2">SUBJECTS</th><th rowspan="2">CREDIT HOUR</th><th rowspan="2">GRADE POINT</th><th rowspan="2">GRADE</th><th rowspan="2">FINAL GRADE</th><th rowspan="2">REMARKS</th></tr><tr></tr></thead><tbody>${tableRowsHTML}</tbody><tfoot><tr><td colspan="5">GRADE POINT AVERAGE (GPA) :</td><td style="text-align:center;">${gpaValue}</td><td></td></tr></tfoot></table></section><section class="notes"><h4>NOTES:</h4><ul><li>TH: Theory</li><li>PR: Practical</li><li>IN: Internal Assessment</li><li>Abs: Absent</li><li>W: Withheld</li><li>NG: Non-Graded</li><li>One Credit Hour = 32 Clock Hours</li></ul></section>`; return gradeSheetHTML; } document.addEventListener('DOMContentLoaded', () => { const searchForm = document.getElementById('searchForm'); if(searchForm) { searchForm.addEventListener('submit', function(event) { event.preventDefault(); const searchSymbol = document.getElementById('symbol').value.trim(); const resultContainer = document.getElementById('gradesheetResult'); const errorContainer = document.querySelector('.search-form-container .error-message'); const actionButtonsDiv = document.getElementById('actionButtonsDiv'); errorContainer.style.display = 'none'; resultContainer.style.display = 'none'; actionButtonsDiv.style.display = 'none'; resultContainer.innerHTML = ''; if (searchSymbol === '') { errorContainer.textContent = 'Please enter a Symbol Number.'; errorContainer.style.display = 'block'; return; } if (typeof allStudentsData !== 'undefined' && typeof allStudentsData === 'object' && allStudentsData !== null) { if (allStudentsData[searchSymbol]) { const student = allStudentsData[searchSymbol]; try { const htmlContent = generateGradeSheetHTML(searchSymbol, student); resultContainer.innerHTML = htmlContent; resultContainer.style.display = 'block'; actionButtonsDiv.style.display = 'block'; } catch (e) { console.error("Error generating grade sheet HTML:", e); errorContainer.textContent = `Error generating gradesheet for ${searchSymbol}. Check console.`; errorContainer.style.display = 'block'; resultContainer.innerHTML = '<p style="color:red; text-align:center; padding:20px;">Could not generate grade sheet due to an error.</p>'; resultContainer.style.display = 'block'; } } else { errorContainer.textContent = `Symbol Number '${searchSymbol}' not found.`; errorContainer.style.display = 'block'; } } else { errorContainer.textContent = 'Error: Student data is not loaded correctly.'; errorContainer.style.display = 'block'; console.error('allStudentsData is not a valid object:', allStudentsData); } }); } else { console.error("Search form not found!"); } const savePngButton = document.getElementById('savePngButton'); if(savePngButton) { savePngButton.addEventListener('click', function() { const gradesheetElement = document.getElementById('gradesheetResult'); if (!gradesheetElement || gradesheetElement.innerHTML.trim() === '' || gradesheetElement.style.display === 'none') { alert("Please search for a student first to display the gradesheet before saving as PNG."); return; } const logoElement = gradesheetElement.querySelector('#schoolLogo'); const symbolInput = document.getElementById('symbol'); const symbol = symbolInput ? symbolInput.value.trim() : 'gradesheet'; let studentName = 'student'; let filename = `GradeSheet_${symbol}.png`; if (typeof allStudentsData !== 'undefined' && allStudentsData && allStudentsData[symbol]) { studentName = allStudentsData[symbol].name ? allStudentsData[symbol].name.replace(/\s+/g, '_') : 'student'; filename = `GradeSheet_${studentName}_${symbol}.png`; } if (gradesheetElement && typeof html2canvas !== 'undefined' && logoElement) { const originalContainerBorder = gradesheetElement.style.border; const originalContainerShadow = gradesheetElement.style.boxShadow; logoElement.classList.add('hide-for-png'); gradesheetElement.style.border = 'none'; gradesheetElement.style.boxShadow = 'none'; gradesheetElement.classList.add('generating-png'); html2canvas(gradesheetElement, { scale: 1.5, useCORS: true, logging: true, backgroundColor: '#ffffff' }) .then(canvas => { logoElement.classList.remove('hide-for-png'); gradesheetElement.classList.remove('generating-png'); gradesheetElement.style.border = originalContainerBorder; gradesheetElement.style.boxShadow = originalContainerShadow; const image = canvas.toDataURL("image/png").replace("image/png", "image/octet-stream"); const link = document.createElement('a'); link.download = filename; link.href = image; document.body.appendChild(link); link.click(); document.body.removeChild(link); }).catch(err => { logoElement.classList.remove('hide-for-png'); gradesheetElement.classList.remove('generating-png'); gradesheetElement.style.border = originalContainerBorder; gradesheetElement.style.boxShadow = originalContainerShadow; console.error('Error generating PNG:', err); if (err.message && err.message.includes('Tainted canvases')) { alert('Could not save as PNG due to image security restrictions (CORS).'); } else { alert('Could not save as PNG. Check browser console (F12) for errors.'); } }); } else { if (!logoElement) alert('Could not find logo element (#schoolLogo) inside the displayed gradesheet.'); else if (typeof html2canvas === 'undefined') alert('html2canvas library not loaded.'); else alert('Could not find the gradesheet content to save.'); } }); } else { console.error("Save PNG button not found!"); } });</script></body></html>