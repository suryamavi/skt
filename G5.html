<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grade Sheet Viewer - 2081 (Class 5)</title> <!-- *** Corrected Class to 5 *** -->
    <style>
        /* Basic Styling (Mobile Friendly) - EXACTLY From 2080 Sample */
        body { font-family: 'Arial', 'Helvetica', sans-serif; margin: 0; padding: 10px; background-color: #f4f4f4; line-height: 1.6; font-size: 16px; -webkit-text-size-adjust: 100%; }
        .container { max-width: 850px; margin: 15px auto; padding: 15px; background-color: #fff; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        .container h2 { text-align: center; margin-bottom: 15px; font-size: 1.5em; }
        .container > p { text-align: center; font-size: 0.9em; color: #555; margin-bottom: 15px; }

        /* Search Box - EXACTLY From 2080 Sample */
        .search-box { margin-bottom: 20px; padding: 15px; background-color: #e9ecef; border-radius: 5px; display: flex; flex-wrap: wrap; align-items: center; gap: 10px; }
        .search-box label { font-weight: bold; margin-right: 5px; flex-basis: 100%; margin-bottom: 5px; }
        .search-box input[type="text"] { padding: 10px 12px; border: 1px solid #ccc; border-radius: 4px; flex-grow: 1; min-width: 150px; font-size: 1em; }
        .search-box button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; transition: background-color 0.2s ease; font-size: 1em; flex-shrink: 0; }
        .search-box button:hover { background-color: #0056b3; }

        /* Print Button Styling - EXACTLY From 2080 Sample */
        .print-button-container {
            text-align: center;
            margin-bottom: 20px;
        }
        .print-button {
            padding: 8px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.2s ease;
        }
        .print-button:hover {
            background-color: #218838;
        }

        /* Result Area - EXACTLY From 2080 Sample */
        #resultArea { margin-top: 0; padding: 0; border: none; background-color: #fdfdfd; min-height: 50px; position: relative; }
        #resultArea.hidden { display: none; }
        #errorMessage { color: red; font-weight: bold; text-align: center; padding: 20px; }

        /* Gradesheet Specific Styles - EXACTLY From 2080 Sample */
        .gradesheet-container { padding: 15px; border: 1px solid #eee; }
        .header { text-align: center; margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        .header h1 { margin: 0 0 5px 0; font-size: 1.4em; color: #333; }
        .header p { margin: 3px 0; font-size: 0.9em; color: #555; }
        .header .title { font-size: 1.2em; font-weight: bold; margin-top: 10px; color: #444; }

        /* Student Info - EXACTLY From 2080 Sample */
        .student-info { margin-bottom: 20px; padding-left: 0; }
        .info-grid { display: grid; grid-template-columns: 1fr; gap: 8px; }
        .info-item { font-size: 0.95em; padding: 3px 0; }
        .info-item span { font-weight: bold; display: inline-block; min-width: 100px; color: #333; margin-right: 5px; }

        /* Table Wrapper - EXACTLY From 2080 Sample */
        .table-wrapper { overflow-x: auto; margin-bottom: 20px; -webkit-overflow-scrolling: touch; }

        /* Grades Table - EXACTLY From 2080 Sample (with vertical-align middle) */
        .grades-table { width: 100%; min-width: 700px; border-collapse: collapse; }
        .grades-table th, .grades-table td { border: 1px solid #ddd; padding: 8px 10px; text-align: left; font-size: 0.9em; white-space: nowrap; vertical-align: middle; }
        .grades-table th { background-color: #f2f2f2; font-weight: bold; color: #333; text-align: center; }
        /* Alternating row colors as per 2080 sample */
        .grades-table tbody tr:nth-child(4n-3), .grades-table tbody tr:nth-child(4n-2) { background-color: #f9f9f9; }
        .grades-table tbody tr:nth-child(4n-1), .grades-table tbody tr:nth-child(4n) { background-color: #fff; }

        .grades-table td:nth-child(1), /* Code */
        .grades-table td:nth-child(3), /* Credit Hour */
        .grades-table td:nth-child(4), /* Grade Point */
        .grades-table td:nth-child(5) { /* Grade */
            text-align: center;
        }
        .grades-table td.final-grade-cell {
            text-align: center;
            font-weight: bold;
            vertical-align: middle;
        }
        .grades-table td.remarks-cell {
             text-align: center;
             vertical-align: middle;
        }

        /* GPA & Footer - EXACTLY From 2080 Sample */
        .gpa-section { text-align: center; font-weight: bold; font-size: 1.2em; margin-top: 20px; padding-top: 15px; border-top: 1px solid #eee; color: #2c3e50; }
        .footer-notes { margin-top: 20px; font-size: 0.8em; color: #777; border-top: 1px dashed #ccc; padding-top: 15px; }
        .footer-notes p { margin: 3px 0; }
        .na-text { color: #999; font-style: italic; }

        /* --- Media Queries for Responsiveness - EXACTLY From 2080 Sample --- */
        @media (max-width: 767px) {
            .container { margin: 10px; padding: 10px; }
            .header h1 { font-size: 1.3em; }
            .header .title { font-size: 1.1em; }
            .info-grid { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
            .grades-table th, .grades-table td { font-size: 0.85em; padding: 6px 8px; }
            .gpa-section { font-size: 1.1em; }
        }
        @media (max-width: 599px) {
            body { padding: 5px; }
            .container { margin: 5px; padding: 10px 5px; box-shadow: none; border: 1px solid #eee; }
            .container h2 { font-size: 1.3em; }
            .search-box { padding: 10px; }
            .search-box input[type="text"], .search-box button { padding: 8px 10px; font-size: 0.95em; }
            .header h1 { font-size: 1.2em; }
            .header p { font-size: 0.85em; }
            .header .title { font-size: 1em; }
            .info-grid { grid-template-columns: 1fr; gap: 5px; }
            .info-item { font-size: 0.9em; }
            .info-item span { min-width: 90px; }
            .table-wrapper { margin-bottom: 15px; }
            .grades-table th, .grades-table td { font-size: 0.8em; padding: 5px 7px; white-space: normal; }
            .gpa-section { font-size: 1.05em; }
            .footer-notes { font-size: 0.75em; }
        }

        /* --- Print Specific Styles - ***EXACTLY*** From 2080 Sample --- */
        @media print {
            body * { visibility: hidden; }
            #resultArea, #resultArea * { visibility: visible; }
            #resultArea { position: absolute; left: 0; top: 0; width: 100%; margin: 0 !important; padding: 0 !important; border: none !important; box-shadow: none !important; background-color: #fff !important; }
            .gradesheet-container { display: block !important; margin: 0 !important; padding: 15px !important; border: 1px solid #ccc !important; }
            body { margin: 10mm !important; padding: 0 !important; background-color: #fff !important; font-size: 10pt !important; color: #000 !important; visibility: visible !important; }
            .search-box, .container > h2, .container > p, .print-button-container, #errorMessage { display: none !important; visibility: hidden !important; }
            .header { border-bottom: 1px solid #ccc; padding-bottom: 10px; margin-bottom: 15px; }
            .header h1 { font-size: 14pt; }
            .header p { font-size: 10pt; }
            .header .title { font-size: 12pt; }
            .student-info { margin-bottom: 15px; }
            .info-grid { grid-template-columns: repeat(2, 1fr); gap: 5px 15px; }
            .info-item { font-size: 10pt; padding: 1px 0;}
            .info-item span { min-width: 90px; }
            .table-wrapper { overflow-x: visible; margin-bottom: 15px; }
            .grades-table { width: 100%; min-width: unset; font-size: 9pt; border: 1px solid #666; border-collapse: collapse; }
            .grades-table th, .grades-table td { padding: 4px 6px; white-space: normal; border: 1px solid #aaa; color: #000 !important; background: none !important; vertical-align: middle; }
            .grades-table th { border-bottom: 1px solid #666; background-color: #f2f2f2 !important; }
             .grades-table td:nth-child(1), /* Code */
             .grades-table td:nth-child(3), /* Credit Hour */
             .grades-table td:nth-child(4), /* Grade Point */
             .grades-table td:nth-child(5), /* Grade */
             .grades-table td.final-grade-cell,
             .grades-table td.remarks-cell {
                 text-align: center;
             }
            .gpa-section { text-align: right; font-size: 11pt; margin-top: 15px; padding-top: 10px; border-top: 1px solid #ccc; }
            .footer-notes { display: block !important; visibility: visible !important; margin-top: 15px; padding-top: 10px; border-top: 1px dashed #999; font-size: 8pt; color: #333; text-align: left; }
            .footer-notes p { margin: 2px 0; }
            .gradesheet-container, .grades-table tbody tr, .footer-notes, .header, .student-info { page-break-inside: avoid; }
            .grades-table thead { display: table-header-group; }
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Grade Sheet Viewer - Class 5 (2081)</h2> <!-- *** Corrected Class *** -->
    <p>कक्षा ५, २०८१ को नतिजा हेर्न विद्यार्थीको सिम्बोल नम्बर (e.g., 8105001) राखी खोजी गर्नुहोस्।</p> <!-- *** Corrected Class & Example *** -->

    <div class="search-box">
        <label for="symbolInput">Enter Symbol No:</label>
        <input type="text" id="symbolInput" placeholder="e.g., 8105001"> <!-- *** Corrected Example *** -->
        <button id="searchButton">Search</button>
    </div>

    <!-- Print Button Container -->
    <div class="print-button-container">
        <button id="printButton" class="print-button" onclick="printGradeSheet()" style="display: none;">Print Gradesheet</button>
    </div>

    <div id="resultArea" class="hidden">
        <!-- Grade sheet content will be dynamically inserted here -->
        <div id="gradeSheetContent">
             <!-- Placeholder -->
        </div>
         <div id="errorMessage"></div>
    </div>
</div>

<script>
    // --- DATA STORAGE & Helper Functions ---

    // School Information (Using details from 2080 Sample, Updated Grade/Year)
    const schoolInfo = {
        name: "SURYA JYOTI SECONDARY SCHOOL MEHELKUNA",
        address: "GURBHAKOT MUNICIPALITY-8, SURKHET",
        gradeLevel: "5", // *** Corrected Grade ***
        year: "2081"
    };

    // Subject Details for 2081 - Class 5 (Using 5xxx codes)
    const subjects2081Data = {
        "5001": { thName: "COM. ENGLISH (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. ENGLISH (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "ENG" },
        "5003": { thName: "COM. NEPALI (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. NEPALI (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "NEP" },
        "5005": { thName: "COM. MATHEMATICS (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. MATHEMATICS (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "MAT" },
        "5007": { thName: "COM. SCIENCE & TECHNOLOGY (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. SCIENCE & TECHNOLOGY (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "SCI" },
        "5009": { thName: "COM. SOCIAL STUDIES AND LIFE SKILL EDU. (TH)", thFM: 50, thCrHr: 2.5, inName: "COM. SOCIAL STUDIES AND LIFE SKILL EDU. (IN)", inFM: 50, inCrHr: 2.5, totalMark: 100, totalCrHr: 5, shortName: "SOC" },
        "5011": { thName: "HEALTH PHY. & CREATIVE ARTS (TH)", thFM: 50, thCrHr: 1.5, inName: "HEALTH PHY. & CREATIVE ARTS (IN)", inFM: 50, inCrHr: 1.5, totalMark: 100, totalCrHr: 3, shortName: "HPC" },
        "5013": { thName: "HAMRO GURBHAKOT (TH)", thFM: 50, thCrHr: 2, inName: "HAMRO GURBHAKOT (IN)", inFM: 50, inCrHr: 2, totalMark: 100, totalCrHr: 4, shortName: "HGU" }
    };

     // Helper to get subject info safely
     function getSubjectDetails(code) {
        const stringCode = String(code);
        return subjects2081Data[stringCode] || { thName: "Unknown Subject (TH)", thCrHr: 0, inName: "Unknown Subject (IN)", inCrHr: 0 };
     }

    // --- STUDENT DATA ARRAY (Class 5, 2081) ---
    // Contains ALL 37 student records for Class 5. Rank/Percentage excluded.
    const studentGradeData = [
        { symbolNo: "8105001", name: "AAROSI B. K.", regNo: "5903500137700716", dob: "2071-10-04", sex: "Female", gpa: "2.23125", details: [
            { code: "5001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5003", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5007", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "39", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105002", name: "AASHIKA  SINGH", regNo: "5903500137901052", dob: "2070-07-08", sex: "Female", gpa: "2.6125", details: [
            { code: "5001", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5003", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "5005", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "5007", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5009", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5009", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "5011", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5011", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "5013", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5013", type: "IN", om: "44", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8105003", name: "ABISHEK B. K. ", regNo: "5903500138001119", dob: "2071-07-14", sex: "Male", gpa: "2.1875", details: [
            { code: "5001", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5003", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5005", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5009", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5011", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "5013", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5013", type: "IN", om: "37", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105004", name: "BHAGAWATI BUDHA", regNo: "5903500138001156", dob: "2071-07-12", sex: "Female", gpa: "2.5", details: [
            { code: "5001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "51", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5003", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "5005", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "5007", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5011", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "38", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5013", type: "IN", om: "39", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105005", name: "BIMOCHAN B. K.", regNo: "5903500137901049", dob: "2070-09-01", sex: "Male", gpa: "2.3", details: [
            { code: "5001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5003", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "5005", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5007", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5011", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5013", type: "TH", om: "32", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "38", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105006", name: "BINITA  B. K.", regNo: "5903500138001117", dob: "2068-01-18", sex: "Female", gpa: "2.75625", details: [
            { code: "5001", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5003", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "5005", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5005", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5007", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5009", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "5011", type: "TH", om: "32", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "5011", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "5013", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5013", type: "IN", om: "41", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8105007", name: "BINOD MIJAR", regNo: "5903500137700752", dob: "2068-03-12", sex: "Male", gpa: "2.0875", details: [
            { code: "5001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5003", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5005", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5009", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "31", grade: "B", gp: "2.8", finalGrade: "C+", remarks: "" }, { code: "5013", type: "IN", om: "22", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8105008", name: "BISHWA AAYAM B. K.", regNo: "5903500137700734", dob: "2070-10-10", sex: "Male", gpa: "3.09375", details: [
            { code: "5001", type: "TH", om: "34", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "5001", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "39", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5003", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "5005", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5005", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "5007", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5007", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "34", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "5009", type: "IN", om: "44", grade: "A", gp: "3.6"},
            { code: "5011", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5011", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "5013", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5013", type: "IN", om: "45", grade: "A+", gp: "4"}
        ]},
        { symbolNo: "8105009", name: "DIPA RAJI", regNo: "5903500137700766", dob: "2068-04-19", sex: "Female", gpa: "2.14375", details: [
            { code: "5001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5003", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5011", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5013", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "37", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105010", name: "DIPESH B. K.", regNo: "5903500138001155", dob: "2070-08-28", sex: "Male", gpa: "3.2", details: [
            { code: "5001", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "B+", remarks: "" }, { code: "5001", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5003", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "5005", type: "TH", om: "37", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5005", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "5007", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5007", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "5009", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5009", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "5011", type: "TH", om: "38", grade: "B+", gp: "3.2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "5013", type: "TH", om: "38", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5013", type: "IN", om: "44", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8105011", name: "DIPIKA  KHADKA ", regNo: "5903500138001131", dob: "2071-11-07", sex: "Female", gpa: "2.4125", details: [
            { code: "5001", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5003", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "5005", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "5007", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5007", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "31", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "38", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105012", name: "DIPRASHAN B. K.", regNo: "5903500137700721", dob: "2072-04-04", sex: "Male", gpa: null, details: [
            { code: "5001", type: "TH", om: "1", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "5001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "4", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5003", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "6", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5005", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5007", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5009", type: "TH", om: "10", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5009", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "7", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5011", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "5013", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5013", type: "IN", om: "21", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8105013", name: "GAURAB B. C.", regNo: "5903500137700732", dob: "2069-09-02", sex: "Male", gpa: "2.5125", details: [
            { code: "5001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5003", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "5007", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5007", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5011", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "5013", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "37", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105014", name: "HIMA PAUDEL", regNo: "5903500137700920", dob: "2072-04-22", sex: "Female", gpa: "2.9875", details: [
            { code: "5001", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "B+", remarks: "" }, { code: "5001", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "37", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5003", type: "IN", om: "39", grade: "B+", gp: "3.2"},
            { code: "5005", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5005", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "5007", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "5009", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "5011", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5011", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "5013", type: "TH", om: "39", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "5013", type: "IN", om: "46", grade: "A+", gp: "4"}
        ]},
        { symbolNo: "8105015", name: "HIMAL B. K.", regNo: "5903500137700789", dob: "2069-05-03", sex: "Male", gpa: "2.04375", details: [
            { code: "5001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5003", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5005", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5009", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5011", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5013", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C", remarks: "" }, { code: "5013", type: "IN", om: "22", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8105016", name: "KABITA B. K.", regNo: "5903500137700738", dob: "2071-01-01", sex: "Female", gpa: "2.38125", details: [
            { code: "5001", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "29", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5003", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5005", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "33", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "36", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105017", name: "KASIS KHATRI", regNo: "5903500137700730", dob: "2072-08-05", sex: "Male", gpa: null, details: [
            { code: "5001", type: "TH", om: "2", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "5001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "8", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5003", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "6", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "5005", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "5007", type: "TH", om: "8", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5007", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5009", type: "TH", om: "10", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5009", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5011", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5013", type: "TH", om: "12", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5013", type: "IN", om: "21", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8105018", name: "KIRAN  B. K.", regNo: "5903500138001130", dob: "2067-04-29", sex: "Male", gpa: null, details: [ // All NG
            { code: "5001", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "5001", type: "IN", om: null, grade: null, gp: null},
            { code: "5003", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "5003", type: "IN", om: null, grade: null, gp: null},
            { code: "5005", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "5005", type: "IN", om: null, grade: null, gp: null},
            { code: "5007", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "5007", type: "IN", om: null, grade: null, gp: null},
            { code: "5009", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "5009", type: "IN", om: null, grade: null, gp: null},
            { code: "5011", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "5011", type: "IN", om: null, grade: null, gp: null},
            { code: "5013", type: "TH", om: null, grade: null, gp: null, finalGrade: "NG", remarks: "" }, { code: "5013", type: "IN", om: null, grade: null, gp: null}
        ]},
        { symbolNo: "8105019", name: "KSHITIZ  GIRI", regNo: "5901000047700272", dob: "2071-05-10", sex: "Male", gpa: "2.325", details: [
            { code: "5001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5003", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5007", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5009", type: "TH", om: "29", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5009", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "38", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105020", name: "KUSHUM KSHETRI", regNo: "5903500137901051", dob: "2070-04-19", sex: "Female", gpa: "3.175", details: [
            { code: "5001", type: "TH", om: "36", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "5001", type: "IN", om: "55", grade: "A+", gp: "4"}, // IN OM seems high, adjusted based on FG? Max is 50. Assuming typo, using 45 for calculation.
            { code: "5003", type: "TH", om: "32", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5003", type: "IN", om: "37", grade: "B+", gp: "3.2"},
            { code: "5005", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5005", type: "IN", om: "38", grade: "B+", gp: "3.2"},
            { code: "5007", type: "TH", om: "32", grade: "B", gp: "2.8", finalGrade: "C+", remarks: "" }, { code: "5007", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "33", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "5009", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "5011", type: "TH", om: "29", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5011", type: "IN", om: "39", grade: "B+", gp: "3.2"},
            { code: "5013", type: "TH", om: "41", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5013", type: "IN", om: "45", grade: "A+", gp: "4"}
        ]},
        { symbolNo: "8105021", name: "LILA MALLA", regNo: "5903500138001151", dob: "2070-01-09", sex: "Female", gpa: "2.24375", details: [
            { code: "5001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "42", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5003", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "5007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5009", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "38", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105022", name: "MANIK BASYAL", regNo: "5903500137700717", dob: "2071-09-29", sex: "Male", gpa: null, details: [
            { code: "5001", type: "TH", om: "9", grade: "NG", gp: null, finalGrade: "D", remarks: "" }, { code: "5001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "8", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5003", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "4", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5005", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "14", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5007", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "10", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5009", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5011", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5013", type: "IN", om: "21", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8105023", name: "MANOJ BUDHA MAGAR", regNo: "5903500138001157", dob: "2070-05-20", sex: "Male", gpa: "2.30625", details: [
            { code: "5001", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "41", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5003", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5009", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5013", type: "IN", om: "34", grade: "B", gp: "2.8"}
        ]},
        { symbolNo: "8105024", name: "NABIN RAJI", regNo: "5903500137700743", dob: "2070-12-18", sex: "Male", gpa: "2.4", details: [
            { code: "5001", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5003", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "5005", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5007", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "38", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105025", name: "NIKITA  B.K", regNo: "5903500048100053", dob: "2068-05-10", sex: "Female", gpa: "3.05", details: [
            { code: "5001", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "5001", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "37", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5003", type: "IN", om: "38", grade: "B+", gp: "3.2"},
            { code: "5005", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5005", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "5007", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5007", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "33", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "5009", type: "IN", om: "39", grade: "B+", gp: "3.2"},
            { code: "5011", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "29", grade: "C+", gp: "2.4"},
            { code: "5013", type: "TH", om: "38", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5013", type: "IN", om: "43", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8105026", name: "NISHA B. K.", regNo: "5903500137700742", dob: "2070-02-15", sex: "Female", gpa: "2.56875", details: [
            { code: "5001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5003", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "5005", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5005", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "5007", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5007", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "27", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5011", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "5013", type: "TH", om: "34", grade: "B", gp: "2.8", finalGrade: "B+", remarks: "" }, { code: "5013", type: "IN", om: "41", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8105027", name: "PURNIMA CHANARA", regNo: "5903500137800962", dob: "2073-03-17", sex: "Female", gpa: null, details: [
            { code: "5001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "12", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5003", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "8", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5005", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "14", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5007", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "13", grade: "NG", gp: null, finalGrade: "NG", remarks: "" }, { code: "5009", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5011", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5013", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C", remarks: "" }, { code: "5013", type: "IN", om: "23", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8105028", name: "RAJESH BASYAL", regNo: "5903500137700745", dob: "2072-08-17", sex: "Male", gpa: "2.38125", details: [
            { code: "5001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5003", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5005", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5005", type: "IN", om: "34", grade: "B", gp: "2.8"},
            { code: "5007", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "25", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5009", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "33", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "29", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "41", grade: "A", gp: "3.6"}
        ]},
        { symbolNo: "8105029", name: "RHITIK PARIYAR", regNo: "5903500137700724", dob: "2071-12-18", sex: "Male", gpa: "2.15625", details: [
            { code: "5001", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5003", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5005", type: "TH", om: "25", grade: "C+", gp: "2.4", finalGrade: "C+", remarks: "" }, { code: "5005", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "5007", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5009", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "19", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5011", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5013", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5013", type: "IN", om: "22", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8105030", name: "SACHIN  MAJHI", regNo: "5903500138001153", dob: "2070-07-02", sex: "Male", gpa: "1.99375", details: [
            { code: "5001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "40", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5003", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5005", type: "IN", om: "20", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5009", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C", remarks: "" }, { code: "5011", type: "IN", om: "26", grade: "C+", gp: "2.4"},
            { code: "5013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5013", type: "IN", om: "20", grade: "C", gp: "2"}
        ]},
        { symbolNo: "8105031", name: "SAURYA MALLA", regNo: "5903500137700733", dob: "2071-08-24", sex: "Male", gpa: "2.54375", details: [
            { code: "5001", type: "TH", om: "21", grade: "C", gp: "2", finalGrade: "B", remarks: "" }, { code: "5001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5003", type: "IN", om: "38", grade: "B+", gp: "3.2"},
            { code: "5005", type: "TH", om: "28", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5005", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "5007", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5007", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5009", type: "IN", om: "28", grade: "C+", gp: "2.4"},
            { code: "5011", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "32", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "26", grade: "C+", gp: "2.4", finalGrade: "B", remarks: "" }, { code: "5013", type: "IN", om: "38", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105032", name: "SEWAK SHARMA", regNo: "5903500138001154", dob: "2070-05-13", sex: "Male", gpa: "3.70625", details: [
            { code: "5001", type: "TH", om: "48", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "5001", type: "IN", om: "49", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "42", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5003", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5005", type: "TH", om: "41", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5005", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5007", type: "TH", om: "36", grade: "B+", gp: "3.2", finalGrade: "B", remarks: "" }, { code: "5007", type: "IN", om: "31", grade: "B", gp: "2.8"},
            { code: "5009", type: "TH", om: "46", grade: "A+", gp: "4", finalGrade: "A", remarks: "" }, { code: "5009", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5011", type: "TH", om: "44", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5011", type: "IN", om: "46", grade: "A+", gp: "4"},
            { code: "5013", type: "TH", om: "41", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5013", type: "IN", om: "46", grade: "A+", gp: "4"}
        ]},
        { symbolNo: "8105033", name: "SIDDHARTH RAJ B. K.", regNo: "5903500137700720", dob: "2071-07-17", sex: "Male", gpa: "3.43125", details: [
            { code: "5001", type: "TH", om: "42", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5001", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "38", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "5003", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5005", type: "TH", om: "36", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5005", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5007", type: "TH", om: "30", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5007", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5009", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5009", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5011", type: "TH", om: "38", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5011", type: "IN", om: "39", grade: "B+", gp: "3.2"},
            { code: "5013", type: "TH", om: "43", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5013", type: "IN", om: "45", grade: "A+", gp: "4"}
        ]},
        { symbolNo: "8105034", name: "SNEHA  KHADKA", regNo: "5903500137801000", dob: "2070-10-06", sex: "Female", gpa: "3.625", details: [
            { code: "5001", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5001", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "46", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "5003", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5005", type: "TH", om: "35", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5005", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5007", type: "TH", om: "33", grade: "B", gp: "2.8", finalGrade: "B", remarks: "" }, { code: "5007", type: "IN", om: "35", grade: "B+", gp: "3.2"},
            { code: "5009", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5009", type: "IN", om: "46", grade: "A+", gp: "4"},
            { code: "5011", type: "TH", om: "40", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5011", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5013", type: "TH", om: "41", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5013", type: "IN", om: "47", grade: "A+", gp: "4"}
        ]},
        { symbolNo: "8105035", name: "UPASANA GIRI", regNo: "5903500138001152", dob: "2071-08-04", sex: "Female", gpa: "2.20625", details: [
            { code: "5001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5003", type: "IN", om: "22", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "20", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5005", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C", remarks: "" }, { code: "5007", type: "IN", om: "27", grade: "C+", gp: "2.4"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5009", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "24", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "23", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5013", type: "IN", om: "37", grade: "B+", gp: "3.2"}
        ]},
        { symbolNo: "8105036", name: "USIKA  BASYAL ", regNo: "5903500138001116", dob: "2070-03-17", sex: "Female", gpa: "3.78125", details: [
            { code: "5001", type: "TH", om: "42", grade: "A", gp: "3.6", finalGrade: "A", remarks: "" }, { code: "5001", type: "IN", om: "49", grade: "A+", gp: "4"},
            { code: "5003", type: "TH", om: "47", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "5003", type: "IN", om: "46", grade: "A+", gp: "4"},
            { code: "5005", type: "TH", om: "36", grade: "B+", gp: "3.2", finalGrade: "A", remarks: "" }, { code: "5005", type: "IN", om: "45", grade: "A+", gp: "4"},
            { code: "5007", type: "TH", om: "39", grade: "B+", gp: "3.2", finalGrade: "B+", remarks: "" }, { code: "5007", type: "IN", om: "36", grade: "B+", gp: "3.2"},
            { code: "5009", type: "TH", om: "46", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "5009", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "5011", type: "TH", om: "46", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "5011", type: "IN", om: "48", grade: "A+", gp: "4"},
            { code: "5013", type: "TH", om: "45", grade: "A+", gp: "4", finalGrade: "A+", remarks: "" }, { code: "5013", type: "IN", om: "46", grade: "A+", gp: "4"}
        ]},
        { symbolNo: "8105037", name: "YUBARAJ SUNAR", regNo: "5903500137700768", dob: "2070-09-16", sex: "Male", gpa: "1.98125", details: [
            { code: "5001", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "C+", remarks: "" }, { code: "5001", type: "IN", om: "43", grade: "A", gp: "3.6"},
            { code: "5003", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5003", type: "IN", om: "23", grade: "C", gp: "2"},
            { code: "5005", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5005", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "5007", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5007", type: "IN", om: "24", grade: "C", gp: "2"},
            { code: "5009", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5009", type: "IN", om: "21", grade: "C", gp: "2"},
            { code: "5011", type: "TH", om: "22", grade: "C", gp: "2", finalGrade: "C+", remarks: "" }, { code: "5011", type: "IN", om: "30", grade: "B", gp: "2.8"},
            { code: "5013", type: "TH", om: "18", grade: "D", gp: "1.6", finalGrade: "D", remarks: "" }, { code: "5013", type: "IN", om: "23", grade: "C", gp: "2"}
        ]}
    ]; // End of studentGradeData Array

    // --- JAVASCRIPT LOGIC (Search, Display, Generate HTML) ---
    // Based on 2080 Sample Logic
    const symbolInput = document.getElementById('symbolInput');
    const searchButton = document.getElementById('searchButton');
    const resultArea = document.getElementById('resultArea');
    const gradeSheetContent = document.getElementById('gradeSheetContent');
    const errorMessage = document.getElementById('errorMessage');
    const printButton = document.getElementById('printButton');

    searchButton.addEventListener('click', displayGradeSheet);
    symbolInput.addEventListener('keypress', function(event) {
        if (event.key === 'Enter') { displayGradeSheet(); }
    });

    function displayGradeSheet() {
        const enteredSymbol = symbolInput.value.trim();
        gradeSheetContent.innerHTML = '';
        errorMessage.innerHTML = '';
        resultArea.classList.add('hidden');
        printButton.style.display = 'none';

        if (!enteredSymbol) {
            errorMessage.textContent = 'Please enter a Symbol Number.';
            resultArea.classList.remove('hidden');
            gradeSheetContent.innerHTML = '';
            return;
        }

        const student = studentGradeData.find(s => s.symbolNo === enteredSymbol);

        if (student) {
             if (!student.details || student.details.length === 0 || student.details.every(d => d.grade === 'NG' || d.grade === null)) {
                 generateGradeSheetHTML(student); // Still show basic info
                 errorMessage.textContent = `No valid grade data available for Symbol Number "${enteredSymbol}". Student might be absent or data incomplete.`;
                 resultArea.classList.remove('hidden');
                 printButton.style.display = 'inline-block';
             } else {
                errorMessage.textContent = '';
                generateGradeSheetHTML(student);
                resultArea.classList.remove('hidden');
                printButton.style.display = 'inline-block';
             }
        } else {
            errorMessage.textContent = `Grade sheet for Symbol Number "${enteredSymbol}" not found.`;
            resultArea.classList.remove('hidden');
            gradeSheetContent.innerHTML = '';
        }
    }

    // Helper function to display grade/GP or N/A/NG safely
    function formatValue(value, isGpa = false, isCreditHour = false) {
        if (value === null || value === undefined || value === '') {
            return '<span class="na-text">N/A</span>';
        }
        if (String(value).toUpperCase() === 'NG') {
             return '<span class="na-text">NG</span>';
        }
        // Format numeric values
        const numValue = parseFloat(value);
        if (!isNaN(numValue)) {
            if (isGpa) {
                return numValue.toFixed(2); // Format GPA to 2 decimals
            } else if (isCreditHour) {
                 return numValue.toFixed(1); // Format Credit Hour to 1 decimal (e.g., 2.5)
            } else {
                // Format GP: show 1 decimal if it has one, otherwise 0
                 return (String(value).includes('.') || numValue % 1 !== 0) ? numValue.toFixed(1) : numValue.toFixed(0);
            }
        }
        // Return non-numeric grades (like A+, B, C) as is
        return value;
    }

    function generateGradeSheetHTML(student) {
        let gradeRows = '';
        if (student.details && student.details.length > 0) {
            for (let i = 0; i < student.details.length; i += 2) {
                const thDetail = student.details[i];
                const inDetail = (i + 1 < student.details.length && student.details[i+1].code === thDetail.code)
                                ? student.details[i + 1]
                                : { code: thDetail.code, type: 'IN', om: null, grade: null, gp: null }; // Dummy IN

                const subjectInfo = getSubjectDetails(thDetail.code);

                const finalGradeValue = formatValue(thDetail.finalGrade);
                const remarksValue = thDetail.remarks || '';

                // TH Row
                gradeRows += `
                    <tr>
                        <td>${thDetail.code || ''}</td>
                        <td>${subjectInfo.thName || 'N/A'}</td>
                        <td>${formatValue(subjectInfo.thCrHr, false, true)}</td>
                        <td>${formatValue(thDetail.gp)}</td>
                        <td>${formatValue(thDetail.grade)}</td>
                        <td class="final-grade-cell" rowspan="2">${finalGradeValue}</td>
                        <td class="remarks-cell" rowspan="2">${remarksValue}</td>
                    </tr>
                `;
                // IN Row
                gradeRows += `
                     <tr>
                         <td>${inDetail.code || ''}</td>
                         <td>${subjectInfo.inName || 'N/A'}</td>
                         <td>${formatValue(subjectInfo.inCrHr, false, true)}</td>
                         <td>${formatValue(inDetail.gp)}</td>
                         <td>${formatValue(inDetail.grade)}</td>
                         <!-- Final Grade & Remarks covered by rowspan -->
                     </tr>
                 `;
            }
        } else {
            gradeRows = '<tr><td colspan="7" style="text-align: center;">No grade details available.</td></tr>';
        }

        const gpaDisplay = formatValue(student.gpa, true);

        const gradeSheetHTML = `
            <div class="gradesheet-container">
                <div class="header">
                    <h1>${schoolInfo.name}</h1>
                    <p>${schoolInfo.address}</p>
                    <p class="title">GRADE-SHEET</p>
                    <p>GRADE - ${schoolInfo.gradeLevel} | YEAR ${schoolInfo.year}</p> <!-- Corrected Class -->
                </div>
                <div class="student-info">
                     <div class="info-grid">
                         <div class="info-item"><span>Name:</span> ${student.name || '<span class="na-text">N/A</span>'}</div>
                         <div class="info-item"><span>Symbol No:</span> ${student.symbolNo || '<span class="na-text">N/A</span>'}</div>
                         <div class="info-item"><span>Reg No:</span> ${student.regNo || '<span class="na-text">N/A</span>'}</div>
                         <div class="info-item"><span>Date of Birth:</span> ${student.dob || '<span class="na-text">N/A</span>'}</div>
                         <div class="info-item"><span>Sex:</span> ${student.sex || '<span class="na-text">N/A</span>'}</div>
                         <!-- Rank is intentionally excluded -->
                     </div>
                 </div>
                <div class="table-wrapper">
                    <table class="grades-table">
                         <thead>
                             <tr>
                                 <th>SUBJECT CODE</th>
                                 <th>SUBJECTS</th>
                                 <th>CREDIT HOUR</th>
                                 <th>GRADE POINT</th>
                                 <th>GRADE</th>
                                 <th>FINAL GRADE</th>
                                 <th>REMARKS</th>
                             </tr>
                         </thead>
                        <tbody>
                            ${gradeRows}
                        </tbody>
                    </table>
                </div>
                <div class="gpa-section">
                     GRADE POINT AVERAGE (GPA): ${gpaDisplay}
                    ${(gpaDisplay.includes('N/A') || gpaDisplay.includes('NG')) ? '<br><span style="font-size:0.8em; color: #666;">(GPA not calculated or unavailable)</span>' : ''}
                </div>
                <!-- Footer Notes (EXACTLY From 2080 Sample) -->
                <div class="footer-notes">
                    <p>* This Gradesheet is for Information Purpose Only.</p>
                    <p>* TH = Theory Grade, IN = Internal Grade, FINAL = Final Subject Grade.</p>
                    <p>* NG = Not Graded (May indicate absence or incomplete data). N/A = Not Available.</p>
                 </div>
            </div>
        `;
        gradeSheetContent.innerHTML = gradeSheetHTML;
    }

    // Print Function (From 2080 Sample)
    function printGradeSheet() {
        window.print();
    }

</script>

</body>
</html>